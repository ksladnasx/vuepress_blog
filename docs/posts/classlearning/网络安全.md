---
date: 2025-12-18
category:
  - 期末复习
tag:
  - 网络安全
---
# 网络安全期末复习核心考点（详细版）

## 第一章 网络安全概述（基础核心）

### 必背核心定义

- **信息安全**：保护信息系统中的信息不被破坏、更改、泄露，确保系统持续提供服务，核心围绕**CIA 三元组**（保密性、完整性、可用性）。
- **网络安全**：覆盖网络硬件、软件及数据的安全，维持网络服务连续运行，延伸目标包括不可抵赖性（数字签名支撑）、可控制性（访问控制实现）。

### 高频考点细节

#### 信息安全发展阶段

- 物体承载阶段：物理防护 + 古典加密（凯撒密码）。
- 通信阶段：传输加密（对称密码）、抗窃听（线路屏蔽）。
- 计算机阶段：访问控制（账户密码）、病毒防御（特征码检测）。
- 网络阶段：防火墙（包过滤）、VPN（隧道加密）、PKI（公钥基础设施）。
- 网络空间阶段：舆情监控、APT 攻击防御、零信任架构。

#### 安全模型

- **P2DR 模型**：策略（风险评估制定规则）→防护（防火墙 / 加密 / 访问控制）→检测（入侵检测 / 日志审计）→响应（隔离 / 修复 / 恢复），核心公式 **Pt（防护时间）< Dt（检测时间）+ Rt（响应时间）**。

- IATF 框架

  ：纵深防御，四大层面：

  1. 本地计算环境：主机防火墙、HIDS、病毒防护。
  2. 区域边界：防火墙（NAT / 包过滤）、VPN 网关、NIDS。
  3. 网络及基础设施：安全路由、负载均衡（抗 DoS）、物理防护。
  4. 支撑性基础设施：PKI（证书颁发 / 验证）、密钥管理。

#### 等级保护 2.0

- 覆盖场景：云计算、移动互联网、物联网、工业控制系统。
- 技术维度：物理环境（机房门禁）、网络安全（分区隔离）、主机安全（漏洞扫描）、应用安全（Web 漏洞防护）、数据安全（加密存储）。
- 管理维度：安全制度、人员管理、建设管理（项目审核）、运维管理（日志审计）。

## 第二章 网络攻击（高频大题考点）

### 核心分类与本质

- **主动攻击**：篡改信息、欺骗、DoS/DDoS、重放，直接改变网络数据或状态，破坏完整性 / 可用性。
- **被动攻击**：嗅探、流量分析、非法访问，不改变数据，仅破坏保密性。

### 重点攻击类型（技术细节 + 防御）

#### 嗅探攻击

- **原理**：网卡设置为**混杂模式**，接收所有流经数据包（无论目的 MAC）。
- **硬件依赖**：集线器（天然广播）、交换机（需 MAC 表溢出或端口镜像）。
- **工具实现（WinPcap）**：NPF 驱动捕获数据包，核心函数`pcap_open_live`（设混杂模式）、`pcap_setfilter`（过滤规则）、`pcap_dump`（存储）。
- **实例**：Ethereal 嗅探邮箱密码，解析 HTTP POST 报文的 “u”（用户名）和 “psw”（密码）字段。
- **防御**：加密传输（HTTPS）、限制交换机端口接入、禁用不必要的混杂模式。

#### 欺骗攻击（ARP/MAC/IP 欺骗）

- ARP 欺骗

  ：

  - 原理：发送伪造 ARP 应答，篡改目标主机 ARP 表（IP 与 MAC 绑定）。
  - 报文构造：源 IP = 网关 IP，源 MAC = 攻击者 MAC，目的 IP = 被欺骗主机 IP，目的 MAC = 被欺骗主机 MAC。
  - 攻击流程：同时欺骗网关和目标主机，形成中间人攻击。
  - 防御：静态 ARP 绑定、交换机启用 ARP 检测、定期校验 ARP 表。

- **MAC 地址欺骗**：发送大量伪造 MAC 的报文，导致交换机 CAM 表溢出（容量 4K/8K），降级为集线器模式（广播转发）。

#### DoS/DDoS 攻击

- SYN 泛洪：

  - 漏洞：利用 TCP 三次握手，伪造源 IP 发送大量 SYN 报文，服务器维持半连接（SYN Timeout 分钟级），耗尽资源。
  - 防御：SYN Cookie（服务器不存半连接，通过 Cookie 验证）、缩短 SYN Timeout（30 秒）、阈值控制（限制每秒 SYN 请求）。
  
- **DDoS 架构**：攻击者→主控机→代理机→目标主机，工具（TFN2K）支持 ICMP/SYN/UDP Flood，通信加密（CAST-256）、进程伪装、数据包尾部填充 16 个 0x00（规避 IDS）。

#### 黑客入侵流程

- 信息收集：nmap 扫描开放端口、Nessus 扫描漏洞、TTL 值判断操作系统版本。
- 扫描技术：TCP Connect（全连接，易检测）、TCP SYN（半连接，隐蔽）、FIN 扫描（无响应则端口开放）。
- 渗透攻击：利用 Web 漏洞上传木马（如 idq.dll）、建立后门（隐藏账户、修改注册表）。

## 第三章 加密算法（核心计算 + 应用）

### 对称加密算法（私钥加密）

#### 技术特征

- 加密 / 解密用同一密钥，速度快，适合大数据量，密钥需安全分发。

#### 典型算法细节

- **DES**：分组长度 64 位（有效 56 位，8 位奇偶校验），16 轮迭代（替换 + 置换 + 异或），缺陷：密钥过短（2^56 种可能），易暴力破解。
- **3DES**：EDE 模式（加密→解密→加密），3 个独立密钥（168 位），兼容 DES，安全性更高。
- **AES（主流）**：分组长度 128 位，密钥长度 128/192/256 位，轮数 10/12/14 轮，每轮含字节代换（SubBytes）、行移位（ShiftRows）、列混合（MixColumns）、轮密钥加（AddRoundKey），优势：速度快、资源消耗低，适用于硬件 / 软件实现。

### 非对称加密算法（公钥加密）

#### 技术特征

- 公钥（公开，加密 / 验证签名）+ 私钥（保密，解密 / 生成签名），安全性基于数学难题，速度慢，适合小数据（密钥交换 / 签名）。

#### 典型算法细节

- RSA：

  - 密钥生成：1. 选大素数 p、q；2. n=p×q；3. φ(n)=(p-1)(q-1)；4. 选 e（1<<e<φ(n)，与 φ(n) 互质，常用 65537）；5. 求 d（e×d≡1 mod φ(n)）。
  - 加密 / 解密：C=M^e mod n，M=C^d mod n。
  - 应用：密钥交换（加密对称密钥）、数字签名。
  
- ECC（椭圆曲线）：

  - 数学基础：椭圆曲线方程 y²=x³+ax+b（有限域 GF (p)），离散对数难题（已知 P 和 kP，求 k 困难）。
- 优势：密钥短（256 位 ECC≈3072 位 RSA）、计算量小，适合移动设备 / 物联网。

### 混合密码体制（核心应用）

#### 流程

1. 发送方生成随机会话密钥（AES 密钥）。
2. 用接收方公钥加密会话密钥（RSA）。
3. 用会话密钥加密原始数据（AES）。
4. 发送 “加密会话密钥 + 加密数据”。

#### 应用：HTTPS（TLS 握手交换会话密钥）、VPN（IPSec 的 IKE 协商会话密钥）。

### 密钥管理

- 生成：随机数生成器，长度达标（AES≥128 位，RSA≥2048 位）。
- 分发：IKE（IPSec）、RADIUS（接入控制）、离线（U 盘 / 硬件密钥）。
- 更新：每 90 天更换，销毁：覆盖存储介质，避免残留。

## 第四章 报文摘要算法（完整性 + 鉴别）

### 核心特性

- 不可逆性（无法反推原始数据）、抗碰撞性（不同数据难生成相同摘要）、抗修改性（数据微小变化→摘要大幅变化），输入任意长度→固定长度输出。

### 典型算法细节

#### MD5

- 输出 128 位（16 字节），流程：
  1. 填充：数据补 1→补 0→长度≡448 mod 512，最后 64 位存原始长度。
  2. 分块：512 位 / 块。
  3. 初始化缓冲区：A=0x67452301，B=0xEFCDAB89，C=0x98BADCFE，D=0x10325476。
  4. 4 轮压缩（每轮 16 步），逻辑运算 F/G/H/I 更新缓冲区。
- 缺陷：抗碰撞性弱，已被破解，不用于安全场景。

#### SHA 系列

- **SHA-1**：160 位摘要，80 轮处理，2005 年被破解。
- **SHA-256**：256 位摘要，512 位分块，8 个初始化寄存器，64 轮迭代，安全性高，常用。
- **SHA-512**：512 位摘要，1024 位分块，适合高安全性需求。

### 应用场景

- 数据完整性：发送方生成摘要，接收方重算对比。
- HMAC：结合密钥（H (D||K)），实现身份鉴别 + 完整性。
- 数字签名：私钥加密摘要，公钥验证（如 RSA 签名）。

## 第五章 接入控制和访问控制（协议 + 机制）

### 身份鉴别

#### 鉴别方式

- 基于共享密钥：双方共享 K，验证 “能否用 K 加密 / 解密随机数”。
- 用户名 + 口令：PAP（明文传输，弱安全）、CHAP（三次握手，基于共享密钥，加密传输）。
- 证书 + 私钥：验证 “能否用私钥签名随机数，公钥验证”。

#### 关键协议

- PPP 协议：

  - 组成：LCP（链路控制）、NCP（网络控制，如 IPCP 分配 IP）。
  - 鉴别协议：PAP（单向，明文）、CHAP（双向，加密，周期性验证）。
  
- 802.1X：
- 基于端口控制，EAP 封装鉴别信息，适用于以太网 / 无线局域网。
  - 架构：客户端（Supplicant）→交换机（Authenticator）→认证服务器（RADIUS）。
- 过程：EAPOL-Start→EAP-Request→EAP-Response→RADIUS 验证→端口授权。

#### 集中式鉴别协议

- **RADIUS**：统一鉴别、授权、计费，支持 PPPoe/802.1X，消息封装在 UDP（端口 1812/1813），共享密钥加密口令，鉴别信息 = MD5（响应消息 || 请求鉴别信息 || 共享密钥）。

- Kerberos：

  - 第三方鉴别（KDC），通过票据实现跨服务器访问，双向鉴别 + 防重放。
- 流程：1. 客户端向 KDC 请求 TGT（票据授予票据）；2. 用 TGT 请求服务票据；3. 用服务票据访问应用服务器。

### 访问控制策略

- 自主访问控制（DAC）：用户自主分配权限（如文件权限）。
- 强制访问控制（MAC）：系统按安全等级控制访问（如军事系统）。
- 基于角色（RBAC）：按角色分配权限（如管理员 / 普通用户），适用于企业场景。

## 第六章 安全协议（高频协议对比）

### IPSec（网际层安全）

#### 核心组件

- AH（协议号 51）：

  - 功能：身份鉴别 + 数据完整性，无加密，验证范围含 IP 头（可变字段除外）+ 净荷。
  - 字段：下一个头、负载长度、SPI、序列号、验证数据（ICV）。
  
- ESP（协议号 50）：

  - 功能：加密 + 鉴别 + 完整性，验证范围含 ESP 头 + 净荷 + 填充 + 填充长度 + 下一个头。
  - 字段：SPI、序列号、荷载数据、填充、填充长度、下一个头、验证数据。
  
- **IKE**：密钥协商，动态建立 SA，分两阶段：1. 建立安全传输通道；2. 建立 SA。

#### 工作模式

- 传输模式：保护 IP 净荷（TCP/UDP），端到端安全，适用于主机间通信。
- 隧道模式：保护整个 IP 分组，封装为新 IP 分组，点到点安全，适用于 VPN 网关间通信。

#### 安全关联（SA）

- 单向通信，三元组（SPI、目的 IP、协议）唯一标识，含序列号计数器、重放窗口、加密 / 鉴别算法、密钥等。

### TLS/SSL（传输层安全）

#### 协议结构

- 握手协议：双向鉴别 + 安全参数协商（加密 / MAC / 压缩算法、密钥）。
- 记录协议：封装上层数据，加密 + 完整性（MAC）。
- 改变密码规范协议：通知启用新安全参数。
- 报警协议：传输出错（解密失败、证书无效）。

#### 握手流程（四阶段）

1. 建立安全协商：Client Hello（版本、随机数、算法列表）→Server Hello（选中算法、服务器随机数）。
2. 服务器鉴别：发送证书→Server-key-exchange（公钥 / 密钥参数）→Server Hello Done。
3. 客户端鉴别：发送证书→Client-key-exchange（预主密钥）→Certificate Verify（签名验证）。
4. 完成：Change Cipher Spec→Finished（验证协商结果）。

#### HTTPS

- 基于 TLS 的 HTTP，实现服务器鉴别、数据加密，流程：TCP 连接→TLS 握手→HTTP 传输。

### 应用层安全协议

- **DNS Sec**：新增 DNSKEY（绑定域名与公钥）、RRSIG（数字签名），保障 DNS 响应真实性 + 完整性。
- **SET**：安全电子交易，用于电子商务，双重签名（保护支付信息 / 订单信息隐私）、数字信封。
- **PGP/S/MIME**：电子邮件安全，PGP 侧重个人（Web of Trust），S/MIME 侧重企业（PKI），实现加密 + 签名。

## 第十章 虚拟专用网络（VPN）（隧道 + 安全）

### 核心技术：隧道技术

- 封装私有 IP 分组，实现身份鉴别（双向）、数据加密（AES）、完整性（HMAC）。

### 分类及细节

VPN 主要根据**隧道技术所在网络层**和**接入场景**分类，核心分为三类

#### 第三层隧道 + IPSec

- 隧道建立在网络层，封装网络层的 IP 分组
- 适用：局域网互连，GRE 封装（协议号 47），IPSec 保障安全。
- GRE 头字段：协议类型（0x800=IP）、Key（32 位，验证来源）、序列号（可选）。
- 流程：私有 IP 分组→**GRE 封装→ESP 加密**→公网传输→解密→解封装→私有 IP 分组。

#### 第二层隧道 + IPSec

- 隧道建立在数据链路层，封装数据链路层的 PPP 帧。
- 适用：远程接入，L2TP 封装 PPP 帧（端口 1701，UDP），结合 IPSec。
- L2TP 隧道建立：1. 控制连接（SCCRP→SCCCN→ACK）；2. 数据隧道（会话标识符 + Cookie）。
- 接入流程：建立 L2TP 隧道→PPP 链路→身份鉴别→分配私有 IP→访问内网。

#### SSL VPN

- 基于应用层 SSL/TLS 协议实现，无需专用隧道协议。
- 优势：基于 HTTPS，无需专用客户端，支持用户授权，远程接入便捷。
- 架构：SSL VPN 网关（连接公网 / 内网）→远程终端（浏览器访问）→内网服务器。
- 流程：HTTPS 握手（鉴别 + 密钥协商）→应用层数据加密传输。

## 第十一章 防火墙（规则 + 配置）

### 分类及工作原理

#### 分组过滤器

- 无状态：仅基于单个 IP 分组（源 / 目的 IP、端口、协议）过滤，如 “禁止 192.168.1.0/24 访问 23 端口（Telnet）”。
- 有状态：结合会话状态（TCP 连接状态、序列号），如 “仅允许内部发起的 TCP 连接的响应报文通过”。
- 防御 SYN 泛洪：阈值控制（半连接数阈值）、SYN Cookie。

#### NAT 技术

- 静态 NAT：私有 IP→固定公有 IP，适用于服务器对外提供服务。
- 动态 NAT：私有 IP→公有 IP 池（会话分配，会话结束释放）。
- PAT（端口多路复用）：多个私有 IP→一个公有 IP + 不同端口，节约公网 IP，常用。
- 配置实例：`nat server protocol tcp global 202.38.160.100 8080 inside 10.110.10.3 www`（内网 Web 服务器对外映射 8080 端口）。

#### 电路层代理

- 流程：终端→代理建立 TCP 连接→代理鉴别身份→代理→服务器建立 TCP 连接→绑定两个连接。
- 应用：穿透防火墙，实现内部网络访问（如 Socks 代理，端口 1080）。

#### 应用层网关（WAF）

- 功能：检测应用层数据（HTTP 字段、SQL 注入、XSS），防御 Web 攻击。
- 工作模式：透明模式（串联在终端与服务器之间）、反向代理模式（路由器转发请求至 WAF）。

## 第十二章 入侵检测系统（IDS）（检测 + 工具）

### 分类

- **NIDS（网络入侵检测）**：检测网段流量，部署在关键链路（如网关出口）。
- **HIDS（主机入侵检测）**：检测主机操作（系统调用、文件修改、日志），部署在重要主机。

### 检测机制

#### 攻击特征检测（误用检测）

- 提取已知攻击特征（元特征 / 有状态特征），匹配流量。
- 特征表示：十六进制（\X01\X86）、字符集（[a-z]）、通配符（* 表示任意次数）。
- 实例：Snort 规则`alert tcp any any -> $HTTP_SERVER 80 (msg:"WEB_IIS cmd.exe access"; uricontent:"cmd.exe"; nocase;)`。

#### 协议译码

- 检测 IP/TCP/ 应用层协议格式合法性，如 IP 分片正确性、TCP 序列号冲突、HTTP 请求与响应匹配。

#### 异常检测

- 基于统计：建立正常流量基准（平均传输速率、数据包长度分布），偏差超阈值则告警。
- 基于规则：定义正常访问规则（如 “交互式 TCP 连接的报文间隔 500ms-30s”），违反则告警。

### 工具：Snort

- 工作模式：嗅探、日志、入侵检测。
- 系统结构：主控模块（初始化 / 规则解析）→解码模块（协议解析）→预处理模块（分片重组）→检测模块（规则匹配）→输出模块（告警 / 日志）。
- 规则结构：动作（alert/log）+ 协议（tcp/udp/ip）+ 源 / 目的 IP + 源 / 目的端口 + 方向（->）+ 选项（msg/content/nocase）。

### 评价指标

- 正确性（误报率）：正常行为误判为攻击的比例。
- 全面性（漏报率）：攻击行为误判为正常的比例。
- 性能：捕获 / 检测速率，支持的并发连接数。