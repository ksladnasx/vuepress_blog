import{_ as s,c as a,a as t,o as e}from"./app-UmXydJji.js";const p={};function l(c,n){return e(),a("div",null,[...n[0]||(n[0]=[t(`<p>æµè§ˆå™¨SSEï¼ˆServer-Sent Eventsï¼ŒæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼‰æ˜¯ä¸€ç§åŸºäºHTTPçš„æŠ€æœ¯ï¼Œå…è®¸æœåŠ¡å™¨ä¸»åŠ¨å°†å®æ—¶æ•°æ®æ¨é€ç»™å®¢æˆ·ç«¯ï¼ˆå¦‚ç½‘é¡µæµè§ˆå™¨ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯åå¤è¯·æ±‚ã€‚</p><h1 id="sseç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#sseç®€ä»‹"><span>SSEç®€ä»‹</span></a></h1><h2 id="sseåŸºæœ¬ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#sseåŸºæœ¬ä»‹ç»"><span>SSEåŸºæœ¬ä»‹ç»</span></a></h2><h3 id="ğŸ”-sseçš„æ ¸å¿ƒç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#ğŸ”-sseçš„æ ¸å¿ƒç‰¹æ€§"><span>ğŸ” SSEçš„æ ¸å¿ƒç‰¹æ€§</span></a></h3><p>SSEçš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶æ˜¯ï¼Œå®¢æˆ·ç«¯é€šè¿‡åˆ›å»ºä¸€ä¸ª<code>EventSource</code>å¯¹è±¡ä¸æœåŠ¡å™¨å»ºç«‹æŒä¹…è¿æ¥ã€‚æœåŠ¡å™¨åˆ™é€šè¿‡å‘é€å…·æœ‰ç‰¹å®š<code>Content-Type: text/event-stream</code>å¤´ä¿¡æ¯çš„å“åº”ï¼Œæ¥ä¿æŒæ­¤è¿æ¥å¼€æ”¾å¹¶æŒç»­æ¨é€æ•°æ®ã€‚</p><p>å…¶å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p><ul><li><p><strong>å•å‘é€šä¿¡</strong>ï¼šæ•°æ®æµåªèƒ½ä»æœåŠ¡å™¨æµå‘å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æ— æ³•é€šè¿‡åŒä¸€è¿æ¥å‘æœåŠ¡å™¨å‘é€æ•°æ®</p></li><li><p><strong>åŸºäºHTTP</strong>ï¼šSSEæ„å»ºåœ¨æ ‡å‡†HTTPåè®®ä¹‹ä¸Šï¼Œå…¼å®¹æ€§è‰¯å¥½ï¼Œæ— éœ€åƒWebSocketé‚£æ ·å¼•å…¥æ–°çš„åè®®</p></li><li><p><strong>è‡ªåŠ¨é‡è¿</strong>ï¼šæµè§ˆå™¨å†…ç½®äº†è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼Œè¿æ¥æ„å¤–ä¸­æ–­æ—¶ä¼šå°è¯•é‡æ–°å»ºç«‹è¿æ¥</p></li><li><p><strong>æ ‡å‡†æ¶ˆæ¯æ ¼å¼</strong>ï¼šæ•°æ®æ ¼å¼ç®€å•ï¼Œé€šå¸¸ä¸ºæ–‡æœ¬ï¼ˆUTF-8ç¼–ç ï¼‰ã€‚æœåŠ¡å™¨å‘é€çš„æ¶ˆæ¯å¯åŒ…å«äº‹ä»¶ç±»å‹ï¼ˆ<code>event</code>ï¼‰ã€æ•°æ®æœ¬èº«ï¼ˆ<code>data</code>ï¼‰ã€æ¶ˆæ¯IDï¼ˆ<code>id</code>ï¼‰å’Œé‡è¿æ—¶é—´ï¼ˆ<code>retry</code>ï¼‰ç­‰å­—æ®µ</p></li></ul><h3 id="âš¡-sseçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#âš¡-sseçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ"><span>âš¡ SSEçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ</span></a></h3><p>å…³äºæ‚¨æåˆ°çš„è¿æ¥æ•°é™åˆ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå…³é”®ç‚¹ï¼š</p><ul><li><p><strong>é»˜è®¤é™åˆ¶</strong>ï¼šåœ¨<strong>HTTP/1.1</strong>åè®®ä¸‹ï¼Œå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ï¼ˆå¦‚Chromeã€Firefoxã€Edgeï¼‰å¯¹<strong>åŒä¸€åŸŸåï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰çš„å¹¶å‘è¿æ¥æ•°é™åˆ¶é€šå¸¸ä¸º6ä¸ª</strong>ã€‚è¿™æ„å‘³ç€ï¼ŒåŒä¸€ä¸ªæµè§ˆå™¨æ ‡ç­¾é¡µï¼ˆæˆ–åŒä¸€æµè§ˆå™¨å®ä¾‹ï¼‰ä¸­ï¼Œå¯¹ç›¸åŒåŸŸåæœ€å¤šåªèƒ½åŒæ—¶å»ºç«‹çº¦6ä¸ªSSEè¿æ¥ï¼Œè¶…å‡ºæ­¤æ•°é‡çš„æ–°è¿æ¥ä¼šè¢«æµè§ˆå™¨é˜»å¡ï¼Œç›´åˆ°æœ‰è¿æ¥è¢«å…³é—­</p></li><li><p><strong>é™åˆ¶åŸå› </strong>ï¼šæ­¤é™åˆ¶æ˜¯HTTP/1.1è§„èŒƒä¸­çš„å†å²é—ç•™è®¾å®šï¼Œæ—¨åœ¨é˜²æ­¢å•ä¸ªå®¢æˆ·ç«¯è¿‡åº¦æ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œç¡®ä¿ç½‘ç»œèµ„æºå…¬å¹³åˆ†é…ã€‚</p></li></ul><p>è‹¥æ‚¨çš„åº”ç”¨éœ€è¦çªç ´æ­¤é™åˆ¶ï¼Œå¯è€ƒè™‘ä»¥ä¸‹æ–¹æ¡ˆï¼š</p><table><thead><tr><th style="text-align:left;">è§£å†³æ–¹æ¡ˆ</th><th style="text-align:left;">æè¿°</th><th style="text-align:left;">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>å‡çº§è‡³HTTP/2</strong></td><td style="text-align:left;">HTTP/2æ”¯æŒ<strong>å¤šè·¯å¤ç”¨</strong>ï¼Œå¯åœ¨å•ä¸ªTCPè¿æ¥ä¸Šå¹¶è¡Œå¤„ç†å¤šä¸ªè¯·æ±‚å’Œå“åº”ï¼Œä»è€Œä»æ ¹æœ¬ä¸Šè§£å†³è¿æ¥æ•°é™åˆ¶é—®é¢˜ã€‚</td><td style="text-align:left;"><strong>é•¿è¿œå’Œæ¨èæ–¹æ¡ˆ</strong>ï¼Œéœ€æœåŠ¡å™¨å’Œæµè§ˆå™¨æ”¯æŒï¼Œé€šå¸¸è¦æ±‚ä½¿ç”¨HTTPSã€‚</td></tr><tr><td style="text-align:left;"><strong>å¤šåŸŸå/å¤šç«¯å£ç­–ç•¥</strong></td><td style="text-align:left;">å°†SSEè¿æ¥åˆ†æ•£åˆ°ä¸åŒçš„å­åŸŸï¼ˆå¦‚<code>sse1.example.com</code>, <code>sse2.example.com</code>ï¼‰æˆ–ä¸åŒç«¯å£å·ã€‚æ¯ä¸ªå­åŸŸæˆ–ç«¯å£äº«æœ‰ç‹¬ç«‹çš„6ä¸ªè¿æ¥é™é¢ã€‚</td><td style="text-align:left;"><strong>è¿‡æ¸¡æ–¹æ¡ˆ</strong>ï¼Œé€‚ç”¨äºæš‚æ— æ³•å‡çº§HTTP/2çš„æƒ…å†µï¼Œä½†é…ç½®ç®¡ç†ç¨å¤æ‚ã€‚</td></tr><tr><td style="text-align:left;"><strong>ä¼˜åŒ–è¿æ¥ä½¿ç”¨</strong></td><td style="text-align:left;">åŠæ—¶å…³é—­ä¸å†éœ€è¦çš„SSEè¿æ¥ï¼Œæˆ–å°è¯•å°†å¤šä¸ªæ•°æ®æµåˆå¹¶åˆ°ä¸€ä¸ªSSEè¿æ¥ä¸­ä¼ è¾“ï¼ˆé€šè¿‡ä¸åŒäº‹ä»¶ç±»å‹åŒºåˆ†ï¼‰ã€‚</td><td style="text-align:left;"><strong>åŸºç¡€ä¼˜åŒ–</strong>ï¼Œè‰¯å¥½çš„è¿æ¥ç®¡ç†ä¹ æƒ¯ã€‚</td></tr></tbody></table><h3 id="ğŸ”„-sseä¸websocketå¦‚ä½•é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#ğŸ”„-sseä¸websocketå¦‚ä½•é€‰æ‹©"><span>ğŸ”„ SSEä¸WebSocketå¦‚ä½•é€‰æ‹©</span></a></h3><p>SSEå¹¶éä¸‡èƒ½ï¼Œç†è§£å…¶ä¸WebSocketçš„åŒºåˆ«æœ‰åŠ©äºæ­£ç¡®é€‰å‹ï¼š</p><table><thead><tr><th style="text-align:left;">ç‰¹æ€§</th><th style="text-align:left;">SSE (Server-Sent Events)</th><th style="text-align:left;">WebSocket</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>é€šä¿¡æ¨¡å¼</strong></td><td style="text-align:left;"><strong>æœåŠ¡å™¨-&gt;å®¢æˆ·ç«¯ï¼ˆå•å‘ï¼‰</strong></td><td style="text-align:left;"><strong>å®¢æˆ·ç«¯&lt;-&gt;æœåŠ¡å™¨ï¼ˆå…¨åŒå·¥ï¼‰</strong></td></tr><tr><td style="text-align:left;"><strong>åè®®åŸºç¡€</strong></td><td style="text-align:left;">HTTP</td><td style="text-align:left;">ç‹¬ç«‹çš„WebSocketåè®®ï¼ˆåŸºäºTCPï¼‰</td></tr><tr><td style="text-align:left;"><strong>å¤æ‚åº¦</strong></td><td style="text-align:left;">ç›¸å¯¹ç®€å•ï¼ŒåŸç”Ÿæ”¯æŒå¥½</td><td style="text-align:left;">ç›¸å¯¹å¤æ‚ï¼Œå¸¸éœ€åº“æ”¯æŒ</td></tr><tr><td style="text-align:left;"><strong>æ–­çº¿é‡è¿</strong></td><td style="text-align:left;"><strong>åŸç”Ÿæ”¯æŒè‡ªåŠ¨é‡è¿</strong></td><td style="text-align:left;">éœ€æ‰‹åŠ¨å®ç°</td></tr><tr><td style="text-align:left;"><strong>æ•°æ®ä¼ è¾“</strong></td><td style="text-align:left;">ä»…æ–‡æœ¬ï¼ˆUTF-8ï¼‰</td><td style="text-align:left;">æ–‡æœ¬å’ŒäºŒè¿›åˆ¶æ•°æ®</td></tr><tr><td style="text-align:left;"><strong>å…¸å‹åœºæ™¯</strong></td><td style="text-align:left;">å®æ—¶æ–°é—»æ¨é€ã€è‚¡ä»·æ›´æ–°ã€ç³»ç»Ÿé€šçŸ¥ã€ç›‘æ§ä»ªè¡¨ç›˜</td><td style="text-align:left;">åœ¨çº¿èŠå¤©å®¤ã€å®æ—¶æ¸¸æˆã€ååŒç¼–è¾‘</td></tr></tbody></table><p>ç®€å•æ¥è¯´ï¼Œè‹¥æ‚¨çš„åº”ç”¨åœºæ™¯ä¸»è¦æ˜¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å•å‘æ¨é€æ•°æ®ï¼ŒSSEå› å…¶ç®€å•æ€§å’Œè‡ªåŠ¨é‡è¿ç­‰ç‰¹æ€§é€šå¸¸æ˜¯æ›´è½»é‡ã€ä¾¿æ·çš„é€‰æ‹©ã€‚è‹¥éœ€è¦é¢‘ç¹çš„åŒå‘äº¤äº’ï¼Œåˆ™WebSocketæ›´åˆé€‚ã€‚</p><h2 id="sseç®€å•ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#sseç®€å•ç¤ºä¾‹"><span>SSEç®€å•ç¤ºä¾‹</span></a></h2><p>Vue3å‰ç«¯ + Node.jsåç«¯</p><h3 id="åç«¯å…³é”®ä»£ç -node-js" tabindex="-1"><a class="header-anchor" href="#åç«¯å…³é”®ä»£ç -node-js"><span>åç«¯å…³é”®ä»£ç  (Node.js)</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// å­˜å‚¨è¿æ¥çš„å®¢æˆ·ç«¯</span></span>
<span class="line"><span class="token keyword">const</span> clients <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// SSEç«¯ç‚¹</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/sse&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;text/event-stream&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&#39;Cache-Control&#39;</span><span class="token operator">:</span> <span class="token string">&#39;no-cache&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&#39;Connection&#39;</span><span class="token operator">:</span> <span class="token string">&#39;keep-alive&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// å°†å®¢æˆ·ç«¯åŠ å…¥åˆ—è¡¨</span></span>
<span class="line">  clients<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// å‘é€è¿æ¥æˆåŠŸæ¶ˆæ¯</span></span>
<span class="line">  res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&#39;data: è¿æ¥æˆåŠŸ\\n\\n&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// å®šæ—¶å‘é€æ¶ˆæ¯</span></span>
<span class="line">  <span class="token keyword">const</span> interval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">data: æœåŠ¡å™¨æ—¶é—´: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\\n\\n</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶æ¸…ç†</span></span>
<span class="line">  req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;close&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> index <span class="token operator">=</span> clients<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> clients<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Server running on port 3000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‰ç«¯å…³é”®ä»£ç -vue3" tabindex="-1"><a class="header-anchor" href="#å‰ç«¯å…³é”®ä»£ç -vue3"><span>å‰ç«¯å…³é”®ä»£ç  (Vue3)</span></a></h3><div class="language-vue line-numbers-mode" data-highlighter="prismjs" data-ext="vue"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>SSEç¤ºä¾‹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>connect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>è¿æ¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>disconnect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>æ–­å¼€<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(msg, index) in messages<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> messages <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> eventSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">connect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// åˆ›å»ºSSEè¿æ¥</span></span>
<span class="line">  eventSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">&#39;http://localhost:3000/sse&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  eventSource<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    messages<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  eventSource<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;SSEé”™è¯¯:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">disconnect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>eventSource<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    eventSource<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    eventSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨æ–­å¼€è¿æ¥</span></span>
<span class="line"><span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¿è¡Œæ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œæ­¥éª¤"><span>è¿è¡Œæ­¥éª¤</span></a></h3><ol><li><strong>åç«¯</strong>ï¼š</li></ol><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd"><pre><code><span class="line">npm install express</span>
<span class="line">node server.js</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><strong>å‰ç«¯</strong>ï¼š</li></ol><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd"><pre><code><span class="line">npm create vue@latest</span>
<span class="line"># å°†ä¸Šé¢çš„Vueä»£ç æ”¾å…¥ç»„ä»¶</span>
<span class="line">npm run dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç®€å•ç¤ºä¾‹å±•ç¤ºäº†SSEçš„æ ¸å¿ƒåŠŸèƒ½ï¼š</p><ul><li>åç«¯å»ºç«‹SSEè¿æ¥å¹¶å®šæ—¶æ¨é€æ¶ˆæ¯</li><li>å‰ç«¯è¿æ¥SSEå¹¶å®æ—¶æ˜¾ç¤ºæ¶ˆæ¯</li><li>åŸºæœ¬çš„è¿æ¥/æ–­å¼€æ§åˆ¶</li></ul>`,29)])])}const i=s(p,[["render",l]]),u=JSON.parse('{"path":"/posts/sse/SSE%E7%AE%80%E4%BB%8B.html","title":"SSEç®€ä»‹","lang":"zh-CN","frontmatter":{"date":"2025-11-24T00:00:00.000Z","category":["è¯´æ˜æ–‡æ¡£"],"tag":["SSE"]},"headers":[{"level":2,"title":"SSEåŸºæœ¬ä»‹ç»","slug":"sseåŸºæœ¬ä»‹ç»","link":"#sseåŸºæœ¬ä»‹ç»","children":[{"level":3,"title":"ğŸ” SSEçš„æ ¸å¿ƒç‰¹æ€§","slug":"ğŸ”-sseçš„æ ¸å¿ƒç‰¹æ€§","link":"#ğŸ”-sseçš„æ ¸å¿ƒç‰¹æ€§","children":[]},{"level":3,"title":"âš¡ SSEçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ","slug":"âš¡-sseçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ","link":"#âš¡-sseçš„è¿æ¥æ•°é™åˆ¶ä¸è§£å†³æ–¹æ¡ˆ","children":[]},{"level":3,"title":"ğŸ”„ SSEä¸WebSocketå¦‚ä½•é€‰æ‹©","slug":"ğŸ”„-sseä¸websocketå¦‚ä½•é€‰æ‹©","link":"#ğŸ”„-sseä¸websocketå¦‚ä½•é€‰æ‹©","children":[]}]},{"level":2,"title":"SSEç®€å•ç¤ºä¾‹","slug":"sseç®€å•ç¤ºä¾‹","link":"#sseç®€å•ç¤ºä¾‹","children":[{"level":3,"title":"åç«¯å…³é”®ä»£ç  (Node.js)","slug":"åç«¯å…³é”®ä»£ç -node-js","link":"#åç«¯å…³é”®ä»£ç -node-js","children":[]},{"level":3,"title":"å‰ç«¯å…³é”®ä»£ç  (Vue3)","slug":"å‰ç«¯å…³é”®ä»£ç -vue3","link":"#å‰ç«¯å…³é”®ä»£ç -vue3","children":[]},{"level":3,"title":"è¿è¡Œæ­¥éª¤","slug":"è¿è¡Œæ­¥éª¤","link":"#è¿è¡Œæ­¥éª¤","children":[]}]}],"git":{"updatedTime":1765244359000,"contributors":[{"name":"ksldnasx","username":"ksldnasx","email":"wh8261408@126.com","commits":3,"url":"https://github.com/ksldnasx"}],"changelog":[{"hash":"a0089923dda5b0a1e568fce8d29533128e78ce23","time":1765244359000,"email":"wh8261408@126.com","author":"ksldnasx","message":"fix:å„ç±»æ–‡ä»¶å¸ƒå±€"},{"hash":"82986032106d89195676536db2e6efd6060346b6","time":1764041784000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:æ–°å¢sseç›¸å…³é¡µé¢ã€‚fix:get-startedé¡µé¢ä¿®æ”¹"},{"hash":"dcb5eab5c577cb78e9ed79126e9ba66cf834a988","time":1763978614000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:å®ä¹ å‘¨æ€»ç»“"}]},"filePathRelative":"posts/sse/SSEç®€ä»‹.md","excerpt":"<p>æµè§ˆå™¨SSEï¼ˆServer-Sent Eventsï¼ŒæœåŠ¡å™¨å‘é€äº‹ä»¶ï¼‰æ˜¯ä¸€ç§åŸºäºHTTPçš„æŠ€æœ¯ï¼Œå…è®¸æœåŠ¡å™¨ä¸»åŠ¨å°†å®æ—¶æ•°æ®æ¨é€ç»™å®¢æˆ·ç«¯ï¼ˆå¦‚ç½‘é¡µæµè§ˆå™¨ï¼‰ï¼Œè€Œæ— éœ€å®¢æˆ·ç«¯åå¤è¯·æ±‚ã€‚</p>\\n<h1>SSEç®€ä»‹</h1>\\n<h2>SSEåŸºæœ¬ä»‹ç»</h2>\\n<h3>ğŸ” SSEçš„æ ¸å¿ƒç‰¹æ€§</h3>\\n<p>SSEçš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶æ˜¯ï¼Œå®¢æˆ·ç«¯é€šè¿‡åˆ›å»ºä¸€ä¸ª<code>EventSource</code>å¯¹è±¡ä¸æœåŠ¡å™¨å»ºç«‹æŒä¹…è¿æ¥ã€‚æœåŠ¡å™¨åˆ™é€šè¿‡å‘é€å…·æœ‰ç‰¹å®š<code>Content-Type: text/event-stream</code>å¤´ä¿¡æ¯çš„å“åº”ï¼Œæ¥ä¿æŒæ­¤è¿æ¥å¼€æ”¾å¹¶æŒç»­æ¨é€æ•°æ®ã€‚</p>\\n<p>å…¶å…³é”®ç‰¹æ€§åŒ…æ‹¬ï¼š</p>"}');export{i as comp,u as data};
