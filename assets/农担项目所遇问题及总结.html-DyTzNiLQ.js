import{_ as s,c as a,a as p,o as t}from"./app-UmXydJji.js";const e={};function l(o,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h1 id="农担项目所遇问题及总结" tabindex="-1"><a class="header-anchor" href="#农担项目所遇问题及总结"><span>农担项目所遇问题及总结</span></a></h1><h2 id="组件封装" tabindex="-1"><a class="header-anchor" href="#组件封装"><span><strong>组件封装</strong></span></a></h2><p>代码中有很多处组件的封装，例如SVG图标的组件封装，在代码中对于icon的展示有独特的封装， 它并非简单的存储svg，而是只存储svg的核心部分，然后再使用<code>forwardRef</code>来实现封装并后期利用className等对svg样式进行修改。这样在代码后续调用的时候就可以对svg图标进行丰富的自定义和操作。</p><p>首先是导入方式，此处在svg的路径后使用了<code>?react</code>后缀，其目的是告诉Vite：将这个SVG文件转换为一个React组件，这样在转化后<code>Assistant</code>就是一个可以直接渲染的React组件：<code>&lt;Assistant / &gt;</code></p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> Assistant <span class="token keyword">from</span> <span class="token string">&quot;./assistant.svg?react&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后在对于类型的定义中，<code>SVGSVGElement</code>：说明ref指向的是<code>&lt;svg&gt;</code>DOM元素，<code>&amp; { className: any }</code>为合并类型，因为转换后的SVG组件可能有className属性便于后期样式修改。</p><p>转发实现部分为<code>((props, ref) =&gt;{}</code>，接收外部的<code>ref</code>和<code>props</code>并直接传递给底层的SVG组件，相当于建立了一个&quot;透明&quot;的传递层。</p><div class="code-block-title"><div class="code-block-title-bar"><span class="title" data-title="测试封装">测试封装</span></div><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line highlighted"><span class="token keyword">import</span> Assistant <span class="token keyword">from</span> <span class="token string">&quot;./assistant.svg?react&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> AssistantIcon <span class="token operator">=</span> <span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span></span>
<span class="line">    SVGSVGElement <span class="token operator">&amp;</span> <span class="token punctuation">{</span> className<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    React<span class="token punctuation">.</span>PropsWithChildren<span class="token operator">&lt;</span><span class="token punctuation">{</span> className<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Assistant</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">...</span>	其余封装类似</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>那么后面使用很方便的一点就是，在简单的导入同时可以利用贴上的ref来直接操作SVG DOM，并且能实现灵活的svg样式控制，例如</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> AssistantIcon<span class="token punctuation">,</span> SkillIcon<span class="token punctuation">,</span> FlowIcon <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./icons&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> iconRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>SVGSVGElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//定义标签iconRef</span></span>
<span class="line"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>iconRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment">//对标签对应组件的各种操作(也就是AssistantIcon这个svg)</span></span>
<span class="line">    <span class="token keyword">const</span> bbox <span class="token operator">=</span> iconRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">getBBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 获取SVG的边界框</span></span>
<span class="line">    iconRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 给svg元素添加动画</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//仅在组件挂载时执行一次</span></span>
<span class="line"><span class="token comment">// 此处传递操作并通过className灵活修改改样式</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AssistantIcon</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>iconRef<span class="token punctuation">}</span></span>  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-6 h-6 text-red-500 hover:text-blue-500<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>  <span class="token comment">//贴上iconRef标签</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="forwardref" tabindex="-1"><a class="header-anchor" href="#forwardref"><span><strong>forwardRef</strong></span></a></h2><h3 id="定义" tabindex="-1"><a class="header-anchor" href="#定义"><span>定义</span></a></h3><p><strong><code>React.forwardRef</code><strong>是一个</strong>高阶函数</strong>，用于创建一个React组件。主要目的是让组件能够接收从其父组件传递下来的 <code>ref</code>，并将其“转发”到组件内部的某个具体的DOM元素或子组件。</p><h3 id="forwardref接收的参数类型" tabindex="-1"><a class="header-anchor" href="#forwardref接收的参数类型"><span>forwardRef接收的参数类型</span></a></h3><p>其中<code>forwardRef&lt;T, P&gt;</code> 接受两个泛型参数：</p><ul><li><strong><code>T</code></strong>：<code>ref</code> 指向的<strong>元素类型</strong></li><li><strong><code>P</code></strong>：组件接受的 <strong>props 类型</strong></li></ul><p>例如<code>forwardRef&lt;SVGSVGElement &amp; { className: any }, React.PropsWithChildren&lt;{ className?: string }&gt; &gt;</code>中：</p><p>第一个参数：<code>SVGSVGElement &amp; { className: any }</code>表示 <code>ref.current</code> 将是一个 <strong>SVG <code>&lt;svg&gt;</code> 元素</strong>，定义了ref这个标签指向的类型。在创建标签的时候就<code>const iconRef = useRef&lt;SVGSVGElement&gt;(null); // 这样声明ref就够了</code></p><p>第二个参数这里是一个<strong>工具类型</strong>，它定义你传的prop只能有className或者children（或者两个都传），例如;</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token comment">/** 此处的props对象为：{ className: &quot;icon-large&quot;, children:[</span>
<span class="line">    &quot;&lt;span&gt;图标&lt;/span&gt;&quot;,</span>
<span class="line">    &quot;点击我&quot; ]} </span>
<span class="line"> **/</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AssistantIcon</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon-large<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">图标</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 点击我</span>
<span class="line"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">AssistantIcon</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码样例" tabindex="-1"><a class="header-anchor" href="#代码样例"><span>代码样例</span></a></h3><p>其实代码中很多地方还有类似的封装，例如对于各种卡片的样式部分，对卡片头部也有类似封装，其中 泛型 <code>&lt;HTMLDivElement, ...&gt;</code> 指定了ref指向的目标类型（一个div）和组件的属性类型：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token comment">// 1. 使用 \`forwardRef\` 创建一个可以转发 ref 的组件</span></span>
<span class="line"><span class="token keyword">const</span> CardHeader <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span> </span>
<span class="line">    HTMLDivElement<span class="token punctuation">,</span> <span class="token comment">// ref最终将被附加到的元素类型（这里是HTMLDivElement）</span></span>
<span class="line">    React<span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span>HTMLDivElement<span class="token operator">&gt;</span>   <span class="token comment">// 组件可以接收的所有props类型（包括所有标准div属性）</span></span>
<span class="line"><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span> <span class="token comment">// 2. \`forwardRef\` 接收一个渲染函数作为参数，这个函数会接收 \`props\` 和从父组件传下来的 \`ref\` 作为其两个参数</span></span>
<span class="line">        <span class="token punctuation">(</span><span class="token punctuation">{</span> className<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span> </span>
<span class="line">        <span class="token comment">// 3. 在内部，将 \`ref\` 和 \`props\` 都绑定到目标元素（div）上</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span></span>
<span class="line">        <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span></span>
<span class="line">        <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">cname</span><span class="token punctuation">(</span><span class="token string">&quot;flex flex-col space-y-1.5 p-5 pb-4&quot;</span><span class="token punctuation">,</span> className<span class="token punctuation">)</span><span class="token punctuation">}</span></span></span>
<span class="line">        <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span></span>
<span class="line">    <span class="token punctuation">/&gt;</span></span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 4. 为组件设置一个清晰的 displayName，便于在React DevTools中调试</span></span>
<span class="line">CardHeader<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">&quot;CardHeader&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此处的ref可以理解为一个**“直接访问标记”<strong>。他就像是给某个组件贴了一个带把手的名牌，那便可以通过这个</strong>把手**（<code>ref.current</code>）直接<strong>拉住</strong>组件进行操作，而不是去通过React的正常“传话”系统（props和state）去间接影响它。因此修改<code>.current</code><strong>不会</strong>触发重渲染儿修改state会触发重新渲染。</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">CardComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 创建ref，指定类型为HTMLDivElement（与forwardRef的泛型一致）</span></span>
<span class="line">  <span class="token keyword">const</span> headerRef <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLDivElement<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>headerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">//利用标签进行DOM元素的直接操作</span></span>
<span class="line">      headerRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&#39;#f0f9ff&#39;</span><span class="token punctuation">;</span></span>
<span class="line">      headerRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> behavior<span class="token operator">:</span> <span class="token string">&#39;smooth&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CardHeader</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>headerRef<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cursor-pointer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  //贴上标签headerRef，同时还传递自定义类名修改样式</span>
<span class="line">        内容</span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">CardHeader</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">高亮头部</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="开会与vibe-coding" tabindex="-1"><a class="header-anchor" href="#开会与vibe-coding"><span>开会与vibe coding</span></a></h2><p>周五还进行了开会，主要内容对于我来讲，就是改变自己编码者的身份，而更多的成为代码的审查者和一个架构者，对于能用ai完成的部分尽量用ai来提升效率，而对于我开发人员来讲，主要就是对代码和业务逻辑的宏观架构和调控。让ai写代码的时候就要更加考虑业务逻辑和代码的优化和后续的维护，而非功能的实现。当然也讲解了智能体的实现等等相关内容。</p><p><strong>Vibe Coding</strong> 是一个与 AI 结对编程的终极工作流程，旨在帮助开发者丝滑地将想法变为现实。本指南详细介绍了从项目构思、技术选型、实施规划到具体开发、调试和扩展的全过程，强调以<strong>规划驱动</strong>和<strong>模块化</strong>为核心，避免让 AI 失控导致项目混乱。这里我还找到了一个食用指南：<a href="https://github.com/tukuaiai/vibe-coding-cn" target="_blank" rel="noopener noreferrer">vibe-coding-cn</a></p><p>当然在ai使用中有很多导致错误的坑，例如对这次项目来说ai修改很坑的一点是改的不完全，例如对于logo判断这里应该是：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"> <span class="token punctuation">{</span>logo <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> logo <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span> <span class="token operator">?</span> </span>
<span class="line">                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>max-w-6 min-w-6 max-h-6 rounded-full overflow-hidden bg-transparent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-6 h-6<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>logo<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">                            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                            <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-6 h-6 min-w-6 flex justify-center items-center bg-transparent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                                </span><span class="token punctuation">{</span>logo<span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">                            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                        <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-8 h-8 min-w-6 flex justify-center items-center bg-transparent<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                                </span><span class="token punctuation">{</span><span class="token comment">/* &lt;AvatarIcon /&gt; */</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">                                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/workflow.svg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>aiLogo<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">                            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是ai有些地方改了有些地方没改，导致后续的logo展示就会有地方展示失败。还有就是对于类名写错的情况，例如对于类名中间加空格导致react没法正常识别出现bug，ai并不能正常的进行识别。这里的h-[calc(100%-104px)]写成了h-[calc(100% - 104px)] 都没法识别，无效改了半天，浪费了时间。</p><h2 id="项目git拉取" tabindex="-1"><a class="header-anchor" href="#项目git拉取"><span>项目git拉取</span></a></h2><p>这个地方有个坑，如果你直接点分支的右上角那个clone按钮复制链接进行git clone,得到的是main分支下的文件而非你所想要的那个分支。正确的方法应该是 克隆的时候克隆指定分支，如这里是customer/cqnd/main分支：</p><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd"><pre><code><span class="line">git clone -b customer/cqnd/main git@git.un-net.com:unnet-llm/adp/postwise.git</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这样获得的文件才是你想要的那个分支的。</p><h2 id="项目启动但无法访问页面" tabindex="-1"><a class="header-anchor" href="#项目启动但无法访问页面"><span>项目启动但无法访问页面</span></a></h2><p>先排查路由文件，路由文件没问题通过命令行进行curl查看</p><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd"><pre><code><span class="line">curl http://localhost:4001/workspace</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如果返回<code>curl: (52) Empty reply from server</code>表示服务器接受了连接，但没有返回任何数据就关闭了连接。有几种可能的原因和解决方法：</p><h3 id="检查端口占用" tabindex="-1"><a class="header-anchor" href="#检查端口占用"><span>检查端口占用</span></a></h3><p>这里我是4001端口</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 查找哪个进程在使用 4001 端口</span></span>
<span class="line"><span class="token function">netstat</span> <span class="token parameter variable">-ano</span> <span class="token operator">|</span> findstr :4001</span>
<span class="line"><span class="token comment"># 记下 PID，然后在任务管理器中查看</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回结果：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>wh82<span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span>netstat <span class="token parameter variable">-ano</span> <span class="token operator">|</span> findstr :4001</span>
<span class="line">  TCP    <span class="token number">0.0</span>.0.0:4001           <span class="token number">0.0</span>.0.0:0              LISTENING       <span class="token number">19416</span></span>
<span class="line">  TCP    <span class="token number">127.0</span>.0.1:4001         <span class="token number">0.0</span>.0.0:0              LISTENING       <span class="token number">6112</span></span>
<span class="line">  TCP    <span class="token number">127.0</span>.0.1:4001         <span class="token number">127.0</span>.0.1:51385        TIME_WAIT       <span class="token number">0</span></span>
<span class="line">  TCP    <span class="token number">127.0</span>.0.1:4001         <span class="token number">127.0</span>.0.1:58250        TIME_WAIT       <span class="token number">0</span></span>
<span class="line">  TCP    <span class="token number">127.0</span>.0.1:50096        <span class="token number">127.0</span>.0.1:4001         TIME_WAIT       <span class="token number">0</span></span>
<span class="line">  TCP    <span class="token number">127.0</span>.0.1:59318        <span class="token number">127.0</span>.0.1:4001         TIME_WAIT       <span class="token number">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>显然看前两个，后面的是回环端口，发现两个进程在争夺同一个端口，则使用 PowerShell进行进程id查看</p><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code><span class="line"><span class="token function">Get-Process</span> <span class="token operator">-</span>Id 19416<span class="token punctuation">,</span>6112</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后停止其中的进程或者应用</p><div class="language-powershell line-numbers-mode" data-highlighter="prismjs" data-ext="powershell"><pre><code><span class="line">taskkill <span class="token operator">/</span>PID 6112 <span class="token operator">/</span>F</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="下载请求得到undefine" tabindex="-1"><a class="header-anchor" href="#下载请求得到undefine"><span>下载请求得到undefine</span></a></h2><p>这个是Blob的解析异常，应该首先看axios的拦截器，有些返回的是response.data导致请求异常，当响应是 Blob 类型（如下载文件）时，拦截器中的 <code>response.data</code> 会被自动转换，这可能导致错误。这里需要对响应拦截器进行修改，增加对于blob类型的响应的判断，如果是此类型直接返回response。或者直接选择绕过利用fetch进行请求。</p><p>增加blob类型的响应的判断判断:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line">customAxios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 检查是否是 blob 响应 ,对于 blob 响应，直接返回 response 而不是 response.data</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>responseType <span class="token operator">===</span> <span class="token string">&#39;blob&#39;</span> <span class="token operator">||</span> </span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/octet-stream&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span></span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/vnd.ms-excel&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span></span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/pdf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">      <span class="token keyword">return</span> response<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>后续代码</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么对应的请求应该规定好返回的类型(这里定义好了返回类型是AxiosResponse，方便后续处理)：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> AxiosResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;../request&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//下载知识库文件，规定好responseType</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span>knowledge_id<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">,</span> file_id<span class="token operator">:</span><span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;axios&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AxiosResponse<span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;ws_token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">/api/v2/filelib/knowledge/file/download/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>knowledge_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>file_id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    responseType<span class="token operator">:</span> <span class="token string">&#39;blob&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="文件下载" tabindex="-1"><a class="header-anchor" href="#文件下载"><span>文件下载</span></a></h2><p>在前面配置好然后就能调用请求进行文件下载了，这里的外层包裹的函数 captureAndAlertRequestErrorHoc是用于对抛出的错误消息进行处理并展示弹窗。同时注意如果下载请求返回的数据类型是json的说明请求遇到错误则抛出异常：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">handleDownload</span> <span class="token operator">=</span> <span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">captureAndAlertRequestErrorHoc</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 检查响应内容类型，注意：现在 response 是 AxiosResponse 对象</span></span>
<span class="line">                <span class="token keyword">const</span> contentType <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token comment">// 如果返回的是 JSON（可能是错误响应），先检查</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>contentType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token comment">// Axios 中，response.data 已经是 blob，需要转换为文本再解析</span></span>
<span class="line">                    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                        reader<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span></span>
<span class="line">                        reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                    <span class="token keyword">const</span> errorData <span class="token operator">=</span> text <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>text <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span>errorData<span class="token punctuation">.</span>status_code <span class="token operator">&amp;&amp;</span> errorData<span class="token punctuation">.</span>status_code <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">下载失败: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>errorData<span class="token punctuation">.</span>status_message <span class="token operator">||</span> errorData<span class="token punctuation">.</span>message <span class="token operator">||</span> errorData<span class="token punctuation">.</span>status_code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">下载失败: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>response<span class="token punctuation">.</span>statusText<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">                <span class="token comment">// response.data 已经是 blob 数据，因为设置了 responseType: &#39;blob&#39;</span></span>
<span class="line">                <span class="token keyword">const</span> blob <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span></span>
<span class="line">                <span class="token comment">// 检查 blob 是否有效</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>blob <span class="token operator">||</span> blob<span class="token punctuation">.</span>size <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;下载失败: 文件内容为空&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">                <span class="token comment">// 使用原始文件名</span></span>
<span class="line">                <span class="token keyword">let</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span>file_name<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token comment">// 创建临时 URL 和下载链接</span></span>
<span class="line">                <span class="token keyword">const</span> downloadUrl <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">const</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                link<span class="token punctuation">.</span>href <span class="token operator">=</span> downloadUrl<span class="token punctuation">;</span></span>
<span class="line">                link<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName<span class="token punctuation">;</span></span>
<span class="line">                document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                window<span class="token punctuation">.</span><span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>downloadUrl<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="react基础学习" tabindex="-1"><a class="header-anchor" href="#react基础学习"><span>react基础学习</span></a></h2><p>React 的三大核心概念：<strong>JSX</strong>、<strong>组件 &amp; Props</strong>、<strong>Hooks</strong>。</p><h3 id="一、jsx-javascript-xml" tabindex="-1"><a class="header-anchor" href="#一、jsx-javascript-xml"><span>一、JSX：JavaScript + XML</span></a></h3><p>它是一种 JavaScript 的语法扩展，允许你在 JavaScript 代码中直接书写类似 HTML 的结构，用来<strong>描述 UI 应该是什么样子</strong>。</p><p><strong>核心要点</strong>：</p><ol><li><strong>它不是字符串，也不是HTML</strong>，最终会被编译成普通的 JavaScript 对象（React 元素）。</li><li><strong>必须有一个根元素</strong>。早期必须用 <code>&lt;div&gt;</code> 包裹，现在推荐使用空的 <code>&lt;&gt;</code>（片段）包裹，避免添加无意义的 DOM 节点。</li><li><strong>在 JSX 中嵌入 JavaScript 表达式</strong>：使用单花括号 <code>{}</code>。这可以是变量、函数调用，或者任何返回值的表达式。</li><li><strong>属性名采用小驼峰命名</strong>：例如 <code>class</code> 要写成 <code>className</code>，<code>onclick</code> 要写成 <code>onClick</code>。</li><li><strong>JSX 本身也是一个表达式</strong>：可以在 <code>if</code> 语句、<code>for</code> 循环中使用，可以赋值给变量，也可以作为函数的参数或返回值。</li></ol><div class="language-jsx line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre><code><span class="line"><span class="token comment">// 嵌入 JavaScript 表达式</span></span>
<span class="line"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">&#39;Alice&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello, </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// JSX 也是一个表达式，可以在条件或循环中使用</span></span>
<span class="line"><span class="token keyword">const</span> showWelcome <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> greeting <span class="token operator">=</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token punctuation">{</span>showWelcome <span class="token operator">?</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Welcome!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span> <span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Please Login</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">&#39;Task 1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Task 2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="二、组件与-props" tabindex="-1"><a class="header-anchor" href="#二、组件与-props"><span>二、组件与 Props</span></a></h3><p><strong>组件</strong>是 React 应用的<strong>构建块</strong>。每个组件都是一个独立的、可复用的 UI 片段。</p><ul><li><strong>定义组件</strong>：就是一个返回 JSX 的 <strong>JavaScript 函数</strong>。<strong>函数名必须以大写字母开头</strong>（这是 React 区分组件和原生 HTML 标签的方式）。</li><li><strong>使用组件</strong>：像使用 HTML 标签一样使用它 <code>&lt;Welcome /&gt;</code>。</li><li><strong>Props</strong>：是组件的 <strong>“输入参数”</strong> ，用于父组件向子组件传递数据。它是以属性形式写在组件标签上的，组件函数通过第一个参数（通常命名为 <code>props</code>）接收。<strong>Props 是只读的</strong>，组件不能修改自己的 props。</li></ul><div class="language-jsx line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre><code><span class="line"><span class="token comment">// 1. 定义一个组件 (函数名大写！)</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Welcome</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// props 接收传入的数据</span></span>
<span class="line">  <span class="token comment">// props 是只读的</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello, </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 2. 使用组件，并传递 props (name=&quot;Sara&quot;)</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Sara<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Cahal<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Edite<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//或者循环调用，注意 name={item} 才会传递动态值即传递数组中的数字值，且要加 key 属性</span></span>
<span class="line"><span class="token keyword">const</span> userList <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;王五&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">28</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">UserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">用户列表</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token punctuation">{</span>userList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> </span>
<span class="line">          <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span>          <span class="token comment">// 使用唯一 id 作为 key</span></span>
<span class="line">          <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> </span>
<span class="line">          <span class="token attr-name">age</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>age<span class="token punctuation">}</span></span></span>
<span class="line">        <span class="token punctuation">/&gt;</span></span></span>
<span class="line">      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>⚠️ 一个关键规则</strong>：<strong>永远不要在组件内部定义另一个组件</strong>。这会导致每次父组件渲染时，子组件都被重新创建和卸载，导致性能问题和状态丢失。正确的做法是将每个组件定义在模块顶层。</p><div class="language-jsx line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre><code><span class="line"><span class="token comment">// ❌ 错误！禁止在组件内定义组件</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">function</span> <span class="token function">Welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 每次 App 渲染都会重新定义 Welcome</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ✅ 正确！将组件定义在顶层</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Welcome</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三、hooks-状态和生命周期" tabindex="-1"><a class="header-anchor" href="#三、hooks-状态和生命周期"><span>三、Hooks：状态和生命周期</span></a></h3><p>在 Hooks 出现之前，函数组件只能接收 props 渲染 UI，没有状态和生命周期。<strong>Hooks 是一系列以 <code>use</code> 开头的特殊函数，它们让你能在函数组件中使用 React 的各种特性</strong>。</p><p><strong>两个最核心的 Hook</strong>：</p><ol><li><p><strong><code>useState</code> - 管理状态</strong></p><ul><li><strong>作用</strong>：在函数组件中添加内部可变的“状态”（state）。</li><li><strong>返回值</strong>：返回一个包含两个元素的数组：<code>[当前状态值, 更新状态的函数]</code>。</li><li><strong>更新状态</strong>：必须使用它返回的 <code>set</code> 函数来更新，直接修改 state 变量不会触发重新渲染。</li></ul><div class="language-jsx line-numbers-mode" data-highlighter="prismjs" data-ext="jsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// count 是当前状态值，setCount 是更新它的函数</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始状态为 0</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      You clicked </span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token plain-text"> times</span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong><code>useEffect</code> - 处理副作用</strong></p><ul><li><strong>作用</strong>：让你在函数组件中执行副作用操作。<strong>副作用</strong>是指那些与渲染结果无关的操作，如数据获取、订阅、手动修改 DOM 等。</li><li><strong>执行时机</strong>：默认情况下，它在 <strong>每次组件渲染完成后</strong>（包括首次渲染）执行。</li><li><strong>依赖数组</strong>：第二个参数是一个数组，用于控制 effect 的执行条件。这是优化性能的关键。 <ul><li><code>useEffect(fn)</code>：<strong>无依赖数组</strong>，每次渲染都执行。</li><li><code>useEffect(fn, [])</code>：<strong>空数组</strong>，仅在组件挂载时执行一次（类似 vue中的<code>onMounted</code>），。</li><li><code>useEffect(fn, [a, b])</code>：<strong>依赖项数组</strong>，当 <code>a</code> 或 <code>b</code> 的值发生变化时才执行。</li></ul></li></ul><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>seconds<span class="token punctuation">,</span> setSeconds<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 这是一个副作用：设置定时器</span></span>
<span class="line">    <span class="token keyword">const</span> intervalId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setSeconds</span><span class="token punctuation">(</span>s <span class="token operator">=&gt;</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 清理函数：在组件卸载或下一次 effect 执行前运行</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>intervalId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 空依赖数组，表示此 effect 只在组件挂载时运行一次</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Seconds: </span><span class="token punctuation">{</span>seconds<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p><strong>Hooks 使用规则（铁律）</strong>：</p><ul><li><strong>只在 React 函数的最顶层调用 Hook</strong>。不要在循环、条件判断或嵌套函数中调用。</li><li><strong>只在 React 函数组件或自定义 Hook 中调用 Hook</strong>。不要在普通的 JavaScript 函数中调用。</li></ul><h3 id="总结与关系" tabindex="-1"><a class="header-anchor" href="#总结与关系"><span>总结与关系</span></a></h3><p>你可以这样理解它们的关系：你用 <strong>JSX</strong> 语法在 <strong>组件</strong> 的函数体内描述 UI 结构；父组件通过 <strong>Props</strong> 将数据和控制逻辑传递下来；组件内部用 <strong>Hooks</strong> 来管理自己的状态（<code>useState</code>）和响应外部世界的变化（<code>useEffect</code>）。这三者共同构成了一个 React 组件的完整逻辑。</p><h2 id="样式修改" tabindex="-1"><a class="header-anchor" href="#样式修改"><span>样式修改</span></a></h2><p>h-[calc(100%-104px)]：含义是父元素的100%减去固定的104px，适配不同缩放比例且依赖父元素，</p><p>h-[calc(100rem-104px)]: 页面整体的字体大小100倍减去104px，会出现页面缩放但是聊天界面不适配的情况（过小或过大）</p><p>对于页面样式要通过justify-between将卡片均匀分布在容器中展示，同时使用不同的媒体查询参数进行卡片间隙的动态变化，如<code>2xl:gap-8</code>，表示：</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">min-width</span><span class="token punctuation">:</span> 1536px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token selector">.\\32xl\\:gap-8</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">gap</span><span class="token punctuation">:</span> 2rem <span class="token comment">/* 32px */</span> <span class="token important">!important</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与后端实习生以及毛学长进行了一些简单的crud接口对接。。。</p><p>对avatar的图片处理逻辑进行优化，如果图片加载异常，不再使用默认图标</p><p>这里的table有源代码的封装，要进行一定样式的传递</p><h2 id="代码逻辑" tabindex="-1"><a class="header-anchor" href="#代码逻辑"><span>代码逻辑</span></a></h2><h3 id="页面创建逻辑" tabindex="-1"><a class="header-anchor" href="#页面创建逻辑"><span>页面创建逻辑</span></a></h3><p>首先明确一点的是，在 <code>src\\components </code>文件夹下是存放着各种可在各个页面中通用复用的组件，这个应该是源代码中编写自带的，例如分页的组件<strong>AutoPagination</strong>。这种在各个页面中用到时，只需要在用到时进行导入并传入需要的参数即可。</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>postwise-table-footer bg-background-login<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">AutoPagination</span></span></span>
<span class="line">                <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>float-right justify-end w-full mr-6<span class="token punctuation">&quot;</span></span></span>
<span class="line">                <span class="token attr-name">page</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>page<span class="token punctuation">}</span></span></span>
<span class="line">                <span class="token attr-name">pageSize</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>pageSize<span class="token punctuation">}</span></span></span>
<span class="line">                <span class="token attr-name">total</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>total<span class="token punctuation">}</span></span></span>
<span class="line">                <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>newPage<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setPage</span><span class="token punctuation">(</span>newPage<span class="token punctuation">)</span><span class="token punctuation">}</span></span></span>
<span class="line">            <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而在项目的具体页面撰写中，以SystemPage模块的代码组织为例，通常遵循以下结构：首先创建名为 <code>System</code> 的目录，并在其中建立入口文件 <code>index.tsx</code> 以及 <code>components</code> 子文件夹。<code>components</code> 文件夹中存放各个独立页面组件，例如 <code>User</code> 组件与 <code>Config</code> 组件，每个组件对应一个具体页面。在每个组件内部，可以编写所需的各种功能函数与 Hook 等处理逻辑，也可以对其他的组件进行引入使用，但仅通过一个默认导出（<code>export default</code>）对外暴露该组件。</p><p>随后，在 <code>index.tsx</code> 中集中导入这些组件，并在页面中进行相应的组合与渲染。最终，该 <code>index.tsx</code> 文件可在路由配置中被引入，从而集成到整体应用的路由体系中。</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> Users <span class="token keyword">from</span> <span class="token string">&quot;./components/Users&quot;</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>userContext<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> t <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useTranslation</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full h-full px-2 pt-4<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Tabs</span></span> <span class="token attr-name">defaultValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>w-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabsList</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabsTrigger</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;system.userManagement&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabsTrigger</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                </span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>role <span class="token operator">===</span> <span class="token string">&#39;admin&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabsTrigger</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userGroup<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;system.userGroupsM&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabsTrigger</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabsTrigger</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>role<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>h-full<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;system.roleManagement&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabsTrigger</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabsList</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabsContent</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Users</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabsContent</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">            。。。其他代码</span>
<span class="line">             </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">};</span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件封装逻辑" tabindex="-1"><a class="header-anchor" href="#组件封装逻辑"><span>组件封装逻辑</span></a></h3><p>在上文提到，在 <code>src\\components </code>文件夹下封装着各种可在各个页面中通用复用的组件，例如Table组件，是封装在<code>src\\components\\bs-ui\\table\\index.tsx</code>下的，他不是仅仅对table进行封装，而是对表头，表项，表行等各种原子组件进行了一个封装，这有便于后续更加个性化的导入使用。</p><p>这里的封装就是利用了forwardRef和各种props来达到更加个性化的目的，这在之前的总结总已经提到过。</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> cname <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../utils&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> Table <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">forwardRef</span><span class="token generic class-name"><span class="token operator">&lt;</span></span>
<span class="line">    HTMLTableElement<span class="token punctuation">,</span></span>
<span class="line">    React<span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span>HTMLTableElement<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> className<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> ref<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">cname</span><span class="token punctuation">(</span><span class="token string">&quot;relative w-full&quot;</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span>onScroll <span class="token operator">?</span> <span class="token string">&quot;&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;overflow-auto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span></span>
<span class="line">            <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span></span>
<span class="line">            <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">cname</span><span class="token punctuation">(</span><span class="token string">&quot;w-full caption-bottom text-sm border-separate border-spacing-y-1&quot;</span><span class="token punctuation">,</span> className<span class="token punctuation">)</span><span class="token punctuation">}</span></span></span>
<span class="line">            <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span></span>
<span class="line">        <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">Table<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token string">&quot;Table&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里在调用这些封装的组件的时候，如果想要传递width: &#39;100%&#39;这种非className的样式信息，则需要作为props传入，对应会传递到上面代码中的<code>{...props}</code>中去，会对应在table中实现，这里是调用示例：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Table<span class="token punctuation">,</span>  TableBody<span class="token punctuation">,</span>  TableRow <span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">.</span> 其他封装的组件<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../../components/bs-ui/table&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Table</span></span> </span>
<span class="line">  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mb-[50px]<span class="token punctuation">&quot;</span></span> </span>
<span class="line">  <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> tableLayout<span class="token operator">:</span> <span class="token string">&#39;fixed&#39;</span><span class="token punctuation">,</span> width<span class="token operator">:</span> <span class="token string">&#39;100%&#39;</span><span class="token punctuation">,</span> minWidth<span class="token operator">:</span> <span class="token string">&#39;1384px&#39;</span> <span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">}</span></span></span>
<span class="line"><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="请求撰写逻辑" tabindex="-1"><a class="header-anchor" href="#请求撰写逻辑"><span>请求撰写逻辑</span></a></h3><p>在项目中，对于请求的撰写函数是专门放在 controllers文件夹下的，文件夹下是request.ts文件和API文件夹，其中request中是对于请求基地址，token等每个请求的公共参数，以及请求拦截器和响应拦截器的封装。响应拦截器可对不同状态的请求响应进行判断和拒绝信息返回。并且响应拦截器对于不同类型的响应也要有不同的判断返回，例如这里对于blob数据的响应返回：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line">customAxios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 检查是否是 blob 响应 ,对于 blob 响应，直接返回 response 而不是 response.data</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>config<span class="token punctuation">.</span>responseType <span class="token operator">===</span> <span class="token string">&#39;blob&#39;</span> <span class="token operator">||</span> </span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/octet-stream&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span></span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/vnd.ms-excel&#39;</span><span class="token punctuation">)</span> <span class="token operator">||</span></span>
<span class="line">        response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;content-type&#39;</span><span class="token punctuation">]</span><span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&#39;application/pdf&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line">      <span class="token keyword">return</span> response<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除此之外request.ts中还对接口异常提示弹窗进行了封装导出，主要用于可视化弹出error信息：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">captureAndAlertRequestErrorHoc</span><span class="token punctuation">(</span>apiFunc<span class="token punctuation">,</span> iocFunc<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> apiFunc<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token comment">// app error</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token operator">?.</span>code <span class="token operator">===</span> <span class="token string">&quot;ERR_CANCELED&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">&#39;canceled&#39;</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;error :&gt;&gt; &#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">         <span class="token comment">//如果error是一个对象，则提取对象属性</span></span>
<span class="line">        <span class="token keyword">const</span> errorMessage <span class="token operator">=</span> error <span class="token keyword">instanceof</span> <span class="token class-name">Error</span> <span class="token operator">?</span> </span>
<span class="line">                    error<span class="token punctuation">.</span>message <span class="token operator">:</span> </span>
<span class="line">                    <span class="token punctuation">(</span><span class="token keyword">typeof</span> error <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span> <span class="token operator">?</span> error <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        iocFunc<span class="token operator">?.</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span></span>
<span class="line">        <span class="token function">toast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 弹窗</span></span>
<span class="line">            title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>i18next<span class="token punctuation">.</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">&#39;prompt&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">            variant<span class="token operator">:</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span></span>
<span class="line">            description<span class="token operator">:</span> errorMessage</span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;逻辑异常 :&gt;&gt; &#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">false</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后API文件下就是各种请求的撰写，当然得分不同的文件名称，不同名称的文件处理不同的组件页面的请求。后续需要进行请求导入请求函数进行请求即可。请求的时候外层加上封装的接口异常提示弹窗，并加上.then处理，大概格式如下：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line"><span class="token keyword">return</span> <span class="token function">captureAndAlertRequestErrorHoc</span><span class="token punctuation">(</span><span class="token function">overridComponent</span><span class="token punctuation">(</span>请求所需的data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                对请求返回的res数据进行操作 <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件渲染逻辑" tabindex="-1"><a class="header-anchor" href="#组件渲染逻辑"><span>组件渲染逻辑</span></a></h3><p>我在代码撰写的时候出现弹窗的无限渲染的错误，究其原因是在React 渲染过程中直接调用可能触发重新渲染的函数导致的无限重复渲染。基本错误逻辑就是：<strong>在渲染过程中直接执行副作用</strong> → 副作用触发重新渲染 → 再次执行副作用 → 无限循环。</p><p>React 组件会因各种原因多次渲染（父组件更新、状态变化等），而副作用函数本身可能触发重新渲染（如某些 toast 实现会更新全局状态）：<strong>渲染 + 副作用 + 重新渲染 = 死循环</strong></p><p>这里的toast弹窗会导致父组件的重新渲染，而重新渲染的时候又会再次执行这个弹窗，又会重新渲染，就会导致无限循环。因此需要将<code>toast()</code> 放在事件回调或 <code>useEffect</code> 中 而不是放在渲染逻辑中：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// ❌ 错误：每次渲染都执行</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">&quot;错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 直接调用</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>错误状态<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// ✅ 正确：只在特定时机执行</span></span>
<span class="line"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">&quot;错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>error<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因此应该保证：</p><ul><li><strong>渲染函数应该是纯的</strong>：不直接修改外部状态</li><li><strong>副作用应该隔离</strong>：放在 <code>useEffect</code> 或事件回调中</li><li><strong>假设组件会多次渲染</strong>：代码要能安全应对重复执行</li></ul><p>同时注意区分useState和useRef：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token comment">// useState - 重新渲染时会重置</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 每次重新渲染：state 会被 React 重新管理</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// useRef - 重新渲染时保持</span></span>
<span class="line"><span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 每次重新渲染：ref.current 保持上次的值</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么便可以使用 <code>useEffect</code> + <code>useRef</code> 来确保副作用只执行一次，<strong>一句话总结</strong>就是别在 React 渲染过程中直接调用可能触发重新渲染的函数，用 <code>useEffect</code> 隔离副作用：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> hasShown <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>hasShown<span class="token punctuation">.</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        hasShown<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">&quot;错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>error<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="vibe-coding方法论" tabindex="-1"><a class="header-anchor" href="#vibe-coding方法论"><span>Vibe coding方法论</span></a></h2><p>个人在coding的时候大部分是用的ai进行辅助编程，这大体也让我发现了各个ai其中的弊端及其用法。</p><p>由于大部分内容的修改实际并不涉及过于深入过于复杂的逻辑撰写，实际上我还是在使用cursor（auto）+国产模型的组合，为此还专门搞了个cursor账号（小贵，要是公司能报销就好了QwQ）。</p><p>然后在我撰写的过程中，我大概发现了ai的各类使用方法。对于cursor，还是适合宏观的代码读取阐述和代码框架结构构建，但是对于代码的局部细致部分结构修改，例如我只是想修改一下背景样式之类的，由于cursor的宏观读取代码的能力，反而会造成一些完全没必要的撰写（例如从某个犄角旮旯调用个组件来复用什么的），对于这类问题，个人觉得还是使用deepseek，复制代码片段直接问方案，然后加上自己的判断比较方便，也能对个人的代码撰写理解有所提示。当然注意使用deepseek的时候别开深度思考，这样才会调用他最新的v3模型。能力更强。至于豆包？虽然看着有点傻（实际上也是），但是他更适合多模态文件的读取，例如git仓库的读取阐述以及样式设计图的读取并给出样式修改意见。</p><p>所以我代码撰写大概的逻辑就是：</p><div class="language-mermaid line-numbers-mode" data-highlighter="prismjs" data-ext="mermaid"><pre><code><span class="line"><span class="token keyword">graph</span> LR</span>
<span class="line"> 	A<span class="token text string">[样式读取设计&lt;br/&gt;【豆包】]</span> </span>
<span class="line">  	A<span class="token arrow operator">--&gt;</span> B<span class="token text string">[形成描述文本&lt;br/&gt;【个人】]</span></span>
<span class="line">    B <span class="token arrow operator">--&gt;</span> C<span class="token text string">[整体代码结构书写&lt;br/&gt;【cursor】]</span></span>
<span class="line">    C <span class="token arrow operator">--&gt;</span> D<span class="token text string">[细处bug和样式调整建议&lt;br/&gt;【deepseek】]</span></span>
<span class="line">    D <span class="token arrow operator">--&gt;</span> E<span class="token text string">[样式调整及bug修复和git提交&lt;br/&gt;【个人】]</span></span>
<span class="line">    E <span class="token arrow operator">--&gt;</span> F<span class="token text string">[需求变动修改代码架构&lt;br/&gt;【cursor】]</span></span>
<span class="line">    F <span class="token arrow operator">--&gt;</span> D</span>
<span class="line">    F <span class="token arrow operator">--&gt;</span> G<span class="token text string">[修改总结形成文档&lt;br/&gt;【个人+deepseek】]</span> </span>
<span class="line">    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总结而言，要与时俱进，减少个人代码撰写量，更多的是需求的理解和代码架构的设计，从编程者变成宏观调控和代码审查者。在我所看的vibe coding 相关的文献资料中，其所对于ai的辅助撰写流程大体分为四个层面</p><h3 id="提示词设计与交互层面" tabindex="-1"><a class="header-anchor" href="#提示词设计与交互层面"><span>提示词设计与交互层面</span></a></h3><p>在提示词设计与交互层面，整体遵循 “精准、简洁、结构化” 的核心原则：输出需剔除客套、修辞等冗余内容，仅保留事实与结论，优先保证准确性而非速度或客套性，信息不足时需标注假设与不确定性来源；总结类输出仅在明确要求时生成，且需简短、无重复、聚焦高价值信息，避免冗余标题；多语言交互以用户提问语言为核心，引用代码元素、文件时必须用反引号标注，工具调用类提示词则限定仅使用指定工具，并行化独立操作、序列化依赖 / 冲突操作，且每批次工具调用前需附加简短的目的或结果说明，高频操作后需暂停给出精简进度节点，同时跳过无意义的客套回应，直接以目标导向的表述开启交互。</p><h3 id="任务规划和执行层面" tabindex="-1"><a class="header-anchor" href="#任务规划和执行层面"><span>任务规划和执行层面</span></a></h3><p>任务规划与执行环节区分任务复杂度制定不同策略：简单任务直接给出执行指导，复杂任务需拆解为可验证的小步骤，将同文件的相关修改归为单一任务，每个实现步骤后紧跟验证环节，避免批量实现后统一验证，任务规划从基础准备工作起步，以集成测试收尾，且未实际执行的任务绝不标记完成；代码编写需从全注释的逐行代码入手，配套算法、复杂度等详细解释，数学公式统一用 LaTeX 呈现，同时避免重复现有代码，以注释占位不变代码段。</p><h3 id="代码审查层面" tabindex="-1"><a class="header-anchor" href="#代码审查层面"><span>代码审查层面</span></a></h3><p>在代码审查层面，构建可量化、可审计的体系。将健壮性、安全性、性能等审查维度拆解为可判定的检查点（CP），每个检查点明确定义、必要性、验证方法与通过标准，标记未知项和维度间的潜在冲突，形成标准化清单而非模糊建议；质量评估围绕可判定性、覆盖完整性、可验证性等五个维度展开，要求检查点覆盖设计、实现、运维等全环节，高风险系统需补充审计日志、权限边界等专项检查，信息不足处需标注 “Unknown” 并给出补充动作，彻底摒弃无落地性的笼统建议。</p><h3 id="结构呈现与持续优化层面" tabindex="-1"><a class="header-anchor" href="#结构呈现与持续优化层面"><span>结构呈现与持续优化层面</span></a></h3><p>在结果呈现与持续优化层面，输出需兼顾可读性与实用性：标题层级清晰且适配内容，可添加少量专业 emoji 提升扫描效率，文件变更需标注用途，性能指标基于实际运行数据并注明硬件 / 系统上下文，终端命令保证可复制且分行呈现；任务完成后需精简总结变更内容与验证方式，同时在实施、调试、优化或出现意外后进行针对性反思，提炼模式、根本原因与经验教训；对话中的建议或追问需控制数量，单条仅承载一个清晰观点，避免信息过载，确保人机协作始终聚焦核心目标。</p><h2 id="工作流节点展示逻辑" tabindex="-1"><a class="header-anchor" href="#工作流节点展示逻辑"><span>工作流节点展示逻辑</span></a></h2><p>工作流节点就是通过配置项（模板）决定不同节点类型的展示：每种节点对应一份“节点模板”，模板里的 group_params 和每个参数的 type 决定画布上该节点会显示哪些分组、哪些表单项，以及每个表单项用哪种控件。</p><h3 id="_1-配置来源-节点模板" tabindex="-1"><a class="header-anchor" href="#_1-配置来源-节点模板"><span>1. 配置来源：节点模板</span></a></h3><ul><li><p>​ 位置：src/controllers/API/workflow.ts</p></li><li><p>变量：workflowTemplate（中文）、workflowTemplateEN（英文）</p></li><li><p>获取方式：getWorkflowNodeTemplate() 根据当前语言返回对应模板数组</p></li></ul><p>每个模板元素对应一种节点类型，结构大致为：</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line"> id<span class="token operator">:</span> <span class="token string">&quot;llm_xxx&quot;</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line"> name<span class="token operator">:</span> <span class="token string">&quot;大模型&quot;</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line"> type<span class="token operator">:</span> <span class="token string">&quot;llm&quot;</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line"> description<span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line"> tab<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token operator">*</span><span class="token comment">// 可选，如单次/批量*</span></span>
<span class="line"></span>
<span class="line"> group_params<span class="token operator">:</span> <span class="token punctuation">[</span>     <span class="token operator">*</span><span class="token comment">// 决定右侧“分组 + 表单项”的展示*</span></span>
<span class="line"></span>
<span class="line">  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;模型设置&quot;</span><span class="token punctuation">,</span> params<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line">  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;提示词&quot;</span><span class="token punctuation">,</span> params<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line">  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;敏感词&quot;</span><span class="token punctuation">,</span> params<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">&quot;sensitive_word_config&quot;</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token string">&quot;sensitive_word_config&quot;</span><span class="token punctuation">,</span> variant<span class="token operator">:</span> <span class="token string">&quot;output&quot;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"> <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>type：节点类型（start / input / llm / agent / rag / output / end 等），用来在侧边栏和画布上区分节点。</p></li><li><p>group_params：直接决定该节点在画布上会展示哪些分组、每组里有哪些表单项。</p></li></ul><h3 id="_2-节点数据从模板到画布" tabindex="-1"><a class="header-anchor" href="#_2-节点数据从模板到画布"><span>2. 节点数据从模板到画布</span></a></h3><ul><li><p>侧边栏：Sidebar.tsx 用 getWorkflowNodeTemplate() 拿到模板列表；拖拽时传的是整份模板（tempData.find(tmp =&gt; tmp.type === item.type)），即包含 group_params 的那一条。</p></li><li><p>画布落点：Panne.tsx 的 onDrop 里用 initNode(flowdata.node) 处理这份模板（主要做变量占位等处理），得到 newNode，再作为 data 赋给 React Flow 的节点：{ id, type: &#39;flowNode&#39;, position, data: newNode }。</p></li><li><p>initNode：src/util/flowUtils.ts 里的 initNode(node) 会遍历 node.group_params，对部分类型（如 var_textarea）做占位符替换，不改变 group_params 的整体结构和 type。</p></li></ul><p>因此：画布上每个节点的 data 里，都带着从模板来的完整 group_params，这就是“配置项”的来源。</p><h3 id="_3-根据配置项渲染-分组-→-参数-→-控件" tabindex="-1"><a class="header-anchor" href="#_3-根据配置项渲染-分组-→-参数-→-控件"><span>3. 根据配置项渲染：分组 → 参数 → 控件</span></a></h3><ul><li><p>FlowNode（FlowNode/index.tsx）</p><ul><li><p>只认一种 React Flow 节点类型：type === &#39;flowNode&#39;。</p></li><li><p>具体是“开始 / 输入 / 大模型 / 助手 / …”完全看 node.data.type 和 node.data.group_params（都来自模板）。</p></li><li><p>ParameterGroup（ParameterGroup.tsx）</p></li><li><p>对当前 Tab 过滤后，遍历 node.group_params 的每一项（一个分组），渲染分组标题（cate.name）和该分组下的 cate.params。</p></li></ul></li><li><p>Parameter（Parameter.tsx）</p><ul><li><p>对每个 param 根据 item.type 做 switch，决定用哪个表单项组件，例如：</p><ul><li><p>textarea → TextAreaItem</p></li><li><p>switch → SwitchItem</p></li><li><p>sensitive_word_config → SensitiveWordConfigItem（再根据 item.variant 区分输入/输出）</p></li><li><p>postwise_model → ModelItem</p></li><li><p>var → VarItem</p></li><li><p>…</p></li></ul></li></ul></li></ul><p>所以：同一套 FlowNode + ParameterGroup + Parameter 用于所有节点类型，差异完全由每个节点 data 里的 group_params 和每个 param 的 type（以及可选的 variant、tab 等）决定。</p><h3 id="_4-小结" tabindex="-1"><a class="header-anchor" href="#_4-小结"><span>4. 小结</span></a></h3><ul><li><p>展示逻辑：通过 节点模板（workflow 里的 workflowTemplate / workflowTemplateEN）定义每种节点（如 start、input、llm、agent、rag）的 group_params。</p></li><li><p>拖拽到画布时，用的是整份模板（含 group_params），经 initNode 后写入节点的 data。</p></li><li><p>画布渲染时，不按“节点类型”写死 UI，而是统一根据 node.data.group_params 和每个 param 的 type 来渲染分组和表单项。</p></li><li><p>是否“通过配置项修改对各类不同节点进行展示”：</p></li></ul><p>那么，改模板里对应节点类型的 group_params（增删分组、增删参数、改 type/variant 等），就会改变该类型节点在画布上的展示；无需改 FlowNode/ParameterGroup/Parameter 的渲染分支（除非新增一种 param.type，需要在 Parameter 里加一种组件）。</p><h2 id="背景图样式被移除" tabindex="-1"><a class="header-anchor" href="#背景图样式被移除"><span>背景图样式被移除</span></a></h2><h3 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h3><p>在client端加入图片背景会产生背景出现又瞬间消失的情况，检查元素发现加背景的那段className被神奇的移除掉了。</p><h3 id="原因说明" tabindex="-1"><a class="header-anchor" href="#原因说明"><span>原因说明</span></a></h3><p>你在 <code>Root.tsx</code> 上加的这段背景：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative z-10 flex h-full flex-1 flex-col overflow-hidden <span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="line">  backgroundImage<span class="token operator">:</span> <span class="token string">&quot;url(&#39;/background.png&#39;)&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  backgroundSize<span class="token operator">:</span> <span class="token string">&#39;cover&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  backgroundPosition<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  backgroundRepeat<span class="token operator">:</span> <span class="token string">&#39;no-repeat&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并不是“被移除掉”，而是<strong>被内部子组件的背景完全覆盖了</strong>：</p><ul><li><code>/c/:conversationId</code> 路由最终渲染的是 <code>ChatRoute</code> → <code>components/Chat/ChatView.tsx</code></li><li><code>ChatView</code> 里面包了一层 <code>Presentation</code> 组件</li><li><code>Presentation</code> 外层用的是：</li></ul><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DragDropWrapper</span></span></span>
<span class="line">  <span class="token attr-name">isLingsi</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isLingsi<span class="token punctuation">}</span></span></span>
<span class="line">  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative flex w-full grow overflow-hidden bg-presentation<span class="token punctuation">&quot;</span></span></span>
<span class="line"><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一切都是<code>bg-presentation</code>搞的鬼！<code>bg-presentation</code> 是一个不透明背景颜色，会铺满整个会话区域，所以你在 <code>Root.tsx</code> 上看到的 <code>background.png</code> 在首屏一闪之后，就被这层 <code>bg-presentation</code> 覆盖，看起来就像“背景被移除了”。</p><h3 id="修复点" tabindex="-1"><a class="header-anchor" href="#修复点"><span>修复点</span></a></h3><p>我并没有再去改这段 <code>Root.tsx</code> 的背景，而是把<strong>盖在原来背景上面的那层背景去掉了</strong>：</p><p>在 <code>components/Chat/Presentation.tsx</code> 中，将：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DragDropWrapper</span></span> <span class="token attr-name">isLingsi</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isLingsi<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative flex w-full grow overflow-hidden bg-presentation<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    ...</span>
<span class="line">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">DragDropWrapper</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>改为：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DragDropWrapper</span></span></span>
<span class="line">    <span class="token attr-name">isLingsi</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isLingsi<span class="token punctuation">}</span></span></span>
<span class="line">    <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>relative flex w-full grow overflow-hidden<span class="token punctuation">&quot;</span></span></span>
<span class="line">  <span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    ...</span>
<span class="line">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">DragDropWrapper</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也就是<strong>去掉了 <code>bg-presentation</code> 这个不透明背景</strong>，让会话区域变成透明背景，这样： <code>Root.tsx</code> 上的 <code>background.png</code> 就能稳定透出来，不会再出现“刷新时出现一下然后瞬间消失”的情况。</p><h3 id="注意" tabindex="-1"><a class="header-anchor" href="#注意"><span>注意</span></a></h3><ul><li>会话消息面板区整体背景 = 在 <code>Root.tsx</code> 上设置的 <code>background.png</code></li><li>内部聊天内容、浮动输入框等都在这张背景图上层渲染，但是如果这些组件有任何使用<code>bg-presentation</code>的情况，原来底层的图片背景还是被覆盖！！</li></ul><h2 id="错误边界逻辑" tabindex="-1"><a class="header-anchor" href="#错误边界逻辑"><span>错误边界逻辑</span></a></h2><p>代码在路由文件中利用包的引入对错误边界处理函数进行了定义：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> ErrorBoundary <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-error-boundary&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> CrashErrorComponent <span class="token keyword">from</span> <span class="token string">&quot;./components/CrashErrorComponent&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">ErrorHoc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> Comp <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorBoundary</span></span></span>
<span class="line">      <span class="token attr-name">onReset</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">}</span></span></span>
<span class="line">      <span class="token attr-name">FallbackComponent</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>CrashErrorComponent<span class="token punctuation">}</span></span></span>
<span class="line">    <span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ErrorBoundary</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">//使用</span></span>
<span class="line"><span class="token keyword">const</span> privateRouter <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> element<span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RedirectToExternalLink</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    path<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    element<span class="token operator">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ErrorHoc</span></span> <span class="token attr-name">Comp</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>MainLayout<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span></span>
<span class="line">    children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中FallbackComponent定义了发生组件渲染错误时进行渲染的页面CrashErrorComponent，而函数的传参是一个组件，通过错误边界函数将组件进行包裹便于后续错误触发时进行反馈。一般是优先包裹外层的组件，防止错误冒泡带来的问题。</p><p>在CrashErrorComponent中我们可以获得<em>error</em>,和<em>resetErrorBoundary</em> ，<code>resetErrorBoundary</code> 是错误边界提供的一个恢复函数，它的核心作用是<strong>重置错误边界状态，尝试重新渲染原本的组件</strong>。具体功能包括：</p><ul><li><strong>状态重置</strong>：将错误边界的内部错误状态重置为 <code>null</code></li><li><strong>重新渲染</strong>：触发错误边界及其子组件的重新渲染</li><li><strong>错误恢复</strong>：如果错误是暂时的（如网络请求失败后重试成功），用户可以点击按钮恢复正常界面</li><li><strong>用户友好</strong>：给用户提供自主恢复的途径，而不是只能刷新页面</li></ul><p><code>error</code> 对象是一个 JavaScript Error 实例，包含了丰富的调试信息：</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx"><pre><code><span class="line"><span class="token comment">// error 对象的典型结构</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 基本信息</span></span>
<span class="line">  name<span class="token operator">:</span> <span class="token string">&quot;TypeError&quot;</span><span class="token punctuation">,</span>         <span class="token comment">// 错误类型：TypeError, ReferenceError, SyntaxError 等</span></span>
<span class="line">  message<span class="token operator">:</span> <span class="token string">&quot;Cannot read property &#39;map&#39; of undefined&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 人类可读的错误描述</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 堆栈追踪（开发环境）</span></span>
<span class="line">  stack<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string"></span>
<span class="line">    at UserList.render (UserList.js:25:15)</span>
<span class="line">    at ReactDOMServerRenderer.render </span>
<span class="line">    at ReactDOMServerRenderer.read</span>
<span class="line">  </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 组件信息（React 16+）</span></span>
<span class="line">  componentStack<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string"></span>
<span class="line">    in UserList (created by Dashboard)</span>
<span class="line">    in Dashboard (created by App)</span>
<span class="line">    in ErrorBoundary (created by App)</span>
<span class="line">    in div (created by App)</span>
<span class="line">    in App</span>
<span class="line">  </span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 可能包含的额外信息</span></span>
<span class="line">  cause<span class="token operator">:</span> originalError<span class="token punctuation">,</span>      <span class="token comment">// 原始错误（如果被包装）</span></span>
<span class="line">  fileName<span class="token operator">:</span> <span class="token string">&quot;UserList.js&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 发生错误的文件</span></span>
<span class="line">  lineNumber<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>           <span class="token comment">// 行号</span></span>
<span class="line">  columnNumber<span class="token operator">:</span> <span class="token number">15</span>          <span class="token comment">// 列号</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过这些信息可对报错进行丰富的自定义，让界面更友好。这里我还做了两个语言的切换版本以及错误代码复制功能等等</p><h2 id="git-cherry-pick" tabindex="-1"><a class="header-anchor" href="#git-cherry-pick"><span>git cherry-pick</span></a></h2><p>我还进行了代码提交的pick，将customer/cqnd/main上的例如样式调整，逻辑修正这种可复用的提交pick到了main分支上，进行了很多代码合并的操作，具体pick的指令用法有：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 将指定的提交应用到当前分支</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token operator">&lt;</span>commit-hash<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 应用多个提交（按顺序）</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token operator">&lt;</span>commit<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span> <span class="token operator">&lt;</span>commit<span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span> <span class="token operator">&lt;</span>commit<span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 应用一系列提交（不包括结束提交）</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token operator">&lt;</span>start-commit<span class="token operator">&gt;</span><span class="token punctuation">..</span><span class="token operator">&lt;</span>end-commit<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 应用一系列提交（包括开始提交）</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token operator">&lt;</span>start-commit<span class="token operator">&gt;</span>^<span class="token punctuation">..</span><span class="token operator">&lt;</span>end-commit<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>常见用到的选项有：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># 解决冲突后继续 cherry-pick，一般用于连续的pick指令</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token parameter variable">--continue</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 取消 cherry-pick 操作，回到操作前的状态，完全放弃，恢复暂存区到之前状态</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token parameter variable">--abort</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 静默退出，暂存区保持当前状态，保留在中间状态</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token parameter variable">--quit</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 应用更改但不自动提交，之后可以手动修改并提交</span></span>
<span class="line"><span class="token function">git</span> cherry-pick <span class="token parameter variable">-n</span> <span class="token operator">&lt;</span>commit-hash<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后一般对于是<strong>merge的提交，是不需要进行pick的</strong>，里面的逻辑分支过于复杂。</p><h2 id="写在最后" tabindex="-1"><a class="header-anchor" href="#写在最后"><span>写在最后</span></a></h2><p>​ 我这周确实是特别忙的一周，因为农担的那个项目年前要上线，各种ui页面的前后端对接，例如召回测试页面的前后端对接，监测面板的前后端对接，敏感词页面的管理制作以及工作流节点部分和助手部分的对敏感词的设置添加对接，ui卡片设计和背景图设计更换等等任务，加上一些之前未发现或者已发现但未完全完善解决的bug，已经把我忙的有些喘不过气来了。由于学校原因不再提供住宿，这周末已经是我能在学校住宿的极限了，因此我不得不提前请假回成都，然后年后再回重庆来。</p><p>​ 这应该是我年前的最后一篇周总结了，个人对今年年末能找到实习并有如此多收获是很满足的，感谢耐心的学长和老师，能带着我一步步成长到现在能熟练解决问题的我。然后我最深刻影响的大概就是我对ai的应用了，一开始我还只是简单的利用国产大模型对组件进行简单的样式修改和逻辑发现，后面用到了学长提供的curosr来进行demo撰写，我深感ai的强大与可怕之处。我后来搞了一个一个月的cursor账号开始自己熟悉，逐渐将自己从一个重复代码的编写者转变为了一个逻辑的提供者和代码的审查者，这一转变显然是高效的，它让我能以更高的效率完成任务，能省下一大笔精力和时间到更需要的工作和学习上去。</p><p>​ 但同时这一转变也是棘手的，它逼迫着我去更多的了解项目的底层代码和底层逻辑，并能有自己的修改理解。有时候AI的修改甚至会陷入死胡同，如果我不具备相关方面的知识，或者没有迅速剖析问题的能力，那很难在较短的时间内发现问题所在。例如之前类名的书写错误导致的样式未生效，ai根本不会指出书写类名时多了空格所以说样式没生效，而只是一味的去堆叠样式堆叠内容最后形成错误答案。遇到这种情况第一时间是要冷静下来自己看，仔细分析组件和样式间的传递和调用逻辑，而不是盲目地将自己的代码书写的主导权交出去。</p><p>​ 自然是适者生存的，人也是。ai取代前端似乎是不可避免的，但人总会不断的去学习适应，人应该凌驾于工具之上而不是被工具所替代。明年会怎么样，未来会怎么样，我并不知道也不想知道，只需要保证能有最好的状态去迎接下一个即将到来的日出，自是会水到渠成而拨开云雾见前路。不必担心和畏惧未来，未来就是还未来，不如去想想下一步该去哪个码头整点薯条来的实在，这也是农担项目做到现在给我最深的感悟。</p>`,187)])])}const i=s(e,[["render",l]]),u=JSON.parse('{"path":"/posts/react/%E5%86%9C%E6%8B%85%E9%A1%B9%E7%9B%AE%E6%89%80%E9%81%87%E9%97%AE%E9%A2%98%E5%8F%8A%E6%80%BB%E7%BB%93.html","title":"农担项目所遇问题及总结","lang":"zh-CN","frontmatter":{"date":"2026-01-23T00:00:00.000Z","category":["项目经验"],"tag":["React","TypeScript"]},"headers":[{"level":2,"title":"组件封装","slug":"组件封装","link":"#组件封装","children":[]},{"level":2,"title":"forwardRef","slug":"forwardref","link":"#forwardref","children":[{"level":3,"title":"定义","slug":"定义","link":"#定义","children":[]},{"level":3,"title":"forwardRef接收的参数类型","slug":"forwardref接收的参数类型","link":"#forwardref接收的参数类型","children":[]},{"level":3,"title":"代码样例","slug":"代码样例","link":"#代码样例","children":[]}]},{"level":2,"title":"开会与vibe coding","slug":"开会与vibe-coding","link":"#开会与vibe-coding","children":[]},{"level":2,"title":"项目git拉取","slug":"项目git拉取","link":"#项目git拉取","children":[]},{"level":2,"title":"项目启动但无法访问页面","slug":"项目启动但无法访问页面","link":"#项目启动但无法访问页面","children":[{"level":3,"title":"检查端口占用","slug":"检查端口占用","link":"#检查端口占用","children":[]}]},{"level":2,"title":"下载请求得到undefine","slug":"下载请求得到undefine","link":"#下载请求得到undefine","children":[]},{"level":2,"title":"文件下载","slug":"文件下载","link":"#文件下载","children":[]},{"level":2,"title":"react基础学习","slug":"react基础学习","link":"#react基础学习","children":[{"level":3,"title":"一、JSX：JavaScript + XML","slug":"一、jsx-javascript-xml","link":"#一、jsx-javascript-xml","children":[]},{"level":3,"title":"二、组件与 Props","slug":"二、组件与-props","link":"#二、组件与-props","children":[]},{"level":3,"title":"三、Hooks：状态和生命周期","slug":"三、hooks-状态和生命周期","link":"#三、hooks-状态和生命周期","children":[]},{"level":3,"title":"总结与关系","slug":"总结与关系","link":"#总结与关系","children":[]}]},{"level":2,"title":"样式修改","slug":"样式修改","link":"#样式修改","children":[]},{"level":2,"title":"代码逻辑","slug":"代码逻辑","link":"#代码逻辑","children":[{"level":3,"title":"页面创建逻辑","slug":"页面创建逻辑","link":"#页面创建逻辑","children":[]},{"level":3,"title":"组件封装逻辑","slug":"组件封装逻辑","link":"#组件封装逻辑","children":[]},{"level":3,"title":"请求撰写逻辑","slug":"请求撰写逻辑","link":"#请求撰写逻辑","children":[]},{"level":3,"title":"组件渲染逻辑","slug":"组件渲染逻辑","link":"#组件渲染逻辑","children":[]}]},{"level":2,"title":"Vibe coding方法论","slug":"vibe-coding方法论","link":"#vibe-coding方法论","children":[{"level":3,"title":"提示词设计与交互层面","slug":"提示词设计与交互层面","link":"#提示词设计与交互层面","children":[]},{"level":3,"title":"任务规划和执行层面","slug":"任务规划和执行层面","link":"#任务规划和执行层面","children":[]},{"level":3,"title":"代码审查层面","slug":"代码审查层面","link":"#代码审查层面","children":[]},{"level":3,"title":"结构呈现与持续优化层面","slug":"结构呈现与持续优化层面","link":"#结构呈现与持续优化层面","children":[]}]},{"level":2,"title":"工作流节点展示逻辑","slug":"工作流节点展示逻辑","link":"#工作流节点展示逻辑","children":[{"level":3,"title":"1. 配置来源：节点模板","slug":"_1-配置来源-节点模板","link":"#_1-配置来源-节点模板","children":[]},{"level":3,"title":"2. 节点数据从模板到画布","slug":"_2-节点数据从模板到画布","link":"#_2-节点数据从模板到画布","children":[]},{"level":3,"title":"3. 根据配置项渲染：分组 → 参数 → 控件","slug":"_3-根据配置项渲染-分组-→-参数-→-控件","link":"#_3-根据配置项渲染-分组-→-参数-→-控件","children":[]},{"level":3,"title":"4. 小结","slug":"_4-小结","link":"#_4-小结","children":[]}]},{"level":2,"title":"背景图样式被移除","slug":"背景图样式被移除","link":"#背景图样式被移除","children":[{"level":3,"title":"问题","slug":"问题","link":"#问题","children":[]},{"level":3,"title":"原因说明","slug":"原因说明","link":"#原因说明","children":[]},{"level":3,"title":"修复点","slug":"修复点","link":"#修复点","children":[]},{"level":3,"title":"注意","slug":"注意","link":"#注意","children":[]}]},{"level":2,"title":"错误边界逻辑","slug":"错误边界逻辑","link":"#错误边界逻辑","children":[]},{"level":2,"title":"git cherry-pick","slug":"git-cherry-pick","link":"#git-cherry-pick","children":[]},{"level":2,"title":"写在最后","slug":"写在最后","link":"#写在最后","children":[]}],"git":{"updatedTime":1770370660000,"contributors":[{"name":"ksldnasx","username":"ksldnasx","email":"wh8261408@126.com","commits":4,"url":"https://github.com/ksldnasx"}],"changelog":[{"hash":"a7b1a081b4194fbbfdd47047d3a32995364c270c","time":1770370660000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:周总结11"},{"hash":"d54fa08b88c6b12d11545dc20da9b14421d765d2","time":1770282515000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:"},{"hash":"489f65a034607e62789b5034c4068a657bf12204","time":1769669571000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:农担项目文档更新"},{"hash":"6f3e9c3de781dae4d92f33d65034d564a07f74cc","time":1769165329000,"email":"wh8261408@126.com","author":"ksldnasx","message":"feat:react项目总结及学习"}]},"filePathRelative":"posts/react/农担项目所遇问题及总结.md","excerpt":"\\n<h2><strong>组件封装</strong></h2>\\n<p>代码中有很多处组件的封装，例如SVG图标的组件封装，在代码中对于icon的展示有独特的封装， 它并非简单的存储svg，而是只存储svg的核心部分，然后再使用<code>forwardRef</code>来实现封装并后期利用className等对svg样式进行修改。这样在代码后续调用的时候就可以对svg图标进行丰富的自定义和操作。</p>\\n<p>首先是导入方式，此处在svg的路径后使用了<code>?react</code>后缀，其目的是告诉Vite：将这个SVG文件转换为一个React组件，这样在转化后<code>Assistant</code>就是一个可以直接渲染的React组件：<code>&lt;Assistant / &gt;</code></p>"}');export{i as comp,u as data};
